<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Expo::ResourceSet
  
    &mdash; Documentation by YARD 0.8.2.1
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (R)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Expo.html" title="Expo (module)">Expo</a></span></span>
     &raquo; 
    <span class="title">ResourceSet</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
    <a class="full_list_link" id="tag_list_link"
        href="../tag_list.html">
      Tag List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Expo::ResourceSet
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Resource.html" title="Expo::Resource (class)">Resource</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Resource.html" title="Expo::Resource (class)">Resource</a></span></li>
          
            <li class="next">Expo::ResourceSet</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/resourceset.rb</dd>
  
</dl>
<div class="clear"></div>





  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#properties-instance_method" title="#properties (instance method)">- (Object) <strong>properties</strong> </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      inherited
      from <span class='object_link'><a href="Resource.html#properties-instance_method" title="Expo::Resource#properties (method)">Resource</a></span>
    </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute properties.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#resources-instance_method" title="#resources (instance method)">- (Object) <strong>resources</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute resources.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-instance_method" title="#type (instance method)">- (Object) <strong>type</strong> </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      inherited
      from <span class='object_link'><a href="Resource.html#type-instance_method" title="Expo::Resource#type (method)">Resource</a></span>
    </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute type.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%3D%3D-instance_method" title="#== (instance method)">- (Object) <strong>==</strong>(set) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%5B%5D-instance_method" title="#[] (instance method)">- (ResourceSet) <strong>[]</strong>(index) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a subset of the ResourceSet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#copy-instance_method" title="#copy (instance method)">- (Object) <strong>copy</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a copy of the ResourceSet Object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">- (Object) <strong>delete</strong>(resource) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_first-instance_method" title="#delete_first (instance method)">- (Object) <strong>delete_first</strong>(resource) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_first_if-instance_method" title="#delete_first_if (instance method)">- (Object) <strong>delete_first_if</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_if-instance_method" title="#delete_if (instance method)">- (Object) <strong>delete_if</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each-instance_method" title="#each (instance method)">- (Object) <strong>each</strong>(type = nil, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Calls block once for each element in self, depending on the type of
resource.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_slice-instance_method" title="#each_slice (instance method)">- (Object) <strong>each_slice</strong>(type = nil, slice_step = 1, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates groups of increasing size based on the slice_step paramater.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_slice_array-instance_method" title="#each_slice_array (instance method)">- (Object) <strong>each_slice_array</strong>(slices = 1, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Fix Me  is the type really important , or were are going to deal always
with nodes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_slice_double-instance_method" title="#each_slice_double (instance method)">- (Object) <strong>each_slice_double</strong>(type = nil, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_slice_power2-instance_method" title="#each_slice_power2 (instance method)">- (Object) <strong>each_slice_power2</strong>(type = nil, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Invokes the block for each set of power of two resources.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eql%3F-instance_method" title="#eql? (instance method)">- (Boolean) <strong>eql?</strong>(set) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Equality between to resoruce sets.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#first-instance_method" title="#first (instance method)">- (Object) <strong>first</strong>(type = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the first element which is an object of the Resource Class.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flatten-instance_method" title="#flatten (instance method)">- (Object) <strong>flatten</strong>(type = nil) </a>
    

    
      (also: #all)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Puts all the resource hierarchy into one ResourceSet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flatten%21-instance_method" title="#flatten! (instance method)">- (Object) <strong>flatten!</strong>(type = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gen_keys-instance_method" title="#gen_keys (instance method)">- (Object) <strong>gen_keys</strong>(type = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (ResourceSet) <strong>initialize</strong>(name = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of ResourceSet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#length-instance_method" title="#length (instance method)">- (Integer) <strong>length</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the number of resources in the ResourceSet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#make_gush_file-instance_method" title="#make_gush_file (instance method)">- (Object) <strong>make_gush_file</strong>(update = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generates a directory.xml file for using as a resources  For Gush.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#make_taktuk_command-instance_method" title="#make_taktuk_command (instance method)">- (Object) <strong>make_taktuk_command</strong>(cmd) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates the taktuk command to execute on the ResourceSet It takes into
account if the resources are grouped under different gatways in order to
perform this execution more efficiently.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#node_file-instance_method" title="#node_file (instance method)">- (Object) <strong>node_file</strong>(update = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generates and return the path of the file which contains the list  of the
nodes’ hostnames.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#push-instance_method" title="#push (instance method)">- (Object) <strong>push</strong>(resource) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a Resource object to the ResourceSet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resource_file-instance_method" title="#resource_file (instance method)">- (Object) <strong>resource_file</strong>(type = nil, update = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generates and return the path of the file which contains the list of the
tipe of resource specify by the argument type.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select-instance_method" title="#select (instance method)">- (Object) <strong>select</strong>(type = nil, props = nil, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_resource-instance_method" title="#select_resource (instance method)">- (Object) <strong>select_resource</strong>(props) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_resource-instance_method" title="#to_resource (instance method)">- (Resource) <strong>to_resource</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a resouce or an array of resources.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#uniq-instance_method" title="#uniq (instance method)">- (ResourceSet) <strong>uniq</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a ResourceSet with unique elements.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#uniq%21-instance_method" title="#uniq! (instance method)">- (Object) <strong>uniq!</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Expo::ResourceSet (class)">ResourceSet</a></span></tt>) <strong>initialize</strong>(name = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A new instance of ResourceSet</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 131</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span> <span class='rubyid_name identifier id'>name</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span> <span class='rparen token'>)</span>
        <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span> <span class='symbol val'>:resource_set</span><span class='comma token'>,</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_name identifier id'>name</span> <span class='rparen token'>)</span>
        <span class='rubyid_@resources ivar id'>@resources</span> <span class='assign token'>=</span> <span class='rubyid_Array constant id'>Array</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
        <span class='rubyid_@resource_files ivar id'>@resource_files</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="properties=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="properties-instance_method">
  
    - (<tt>Object</tt>) <strong>properties</strong> 
  

  

  
    <span class="not_defined_here">
      Originally defined in class
        <span class='object_link'><a href="Resource.html#properties-instance_method" title="Expo::Resource#properties (method)">Resource</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute properties</p>


  </div>
</div>
<div class="tags">
  

</div>
</div>
    
      
      <span id="resources=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="resources-instance_method">
  
    - (<tt>Object</tt>) <strong>resources</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute resources</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


130
131
132</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 130</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_resources identifier id'>resources</span>
  <span class='rubyid_@resources ivar id'>@resources</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="type=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="type-instance_method">
  
    - (<tt>Object</tt>) <strong>type</strong> 
  

  

  
    <span class="not_defined_here">
      Originally defined in class
        <span class='object_link'><a href="Resource.html#type-instance_method" title="Expo::Resource#type (method)">Resource</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute type</p>


  </div>
</div>
<div class="tags">
  

</div>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="==-instance_method">
  
    - (<tt>Object</tt>) <strong>==</strong>(set) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


421
422
423</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 421</span>

<span class='rubyid_def def kw'>def</span> <span class='eq op'>==</span><span class='lparen token'>(</span> <span class='rubyid_set identifier id'>set</span> <span class='rparen token'>)</span>
        <span class='rubyid_super super kw'>super</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_@resources ivar id'>@resources</span> <span class='eq op'>==</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="[]-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Expo::ResourceSet (class)">ResourceSet</a></span></tt>) <strong>[]</strong>(index) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>It can be used with a range as a parameter.</p>
</div>
  </div>


<p>Returns a subset of the ResourceSet.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><span class='rubyid_all identifier id'>all</span><span class='lbrack token'>[</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>6</span><span class='rbrack token'>]</span> <span class='rubyid_extract identifier id'>extract</span> <span class='rubyid_resources identifier id'>resources</span> <span class='rubyid_from identifier id'>from</span> <span class='integer val'>1</span> <span class='rubyid_to identifier id'>to</span> <span class='integer val'>6</span>
<span class='rubyid_all identifier id'>all</span><span class='lbrack token'>[</span><span class='string val'>&quot;lyon&quot;</span><span class='rbrack token'>]</span> <span class='rubyid_extract identifier id'>extract</span> <span class='rubyid_the identifier id'>the</span> <span class='rubyid_resources identifier id'>resources</span> <span class='rubyid_form identifier id'>form</span> <span class='rubyid_lyon identifier id'>lyon</span> <span class='rubyid_cluster identifier id'>cluster</span>
  <span class='rubyid_all identifier id'>all</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>  <span class='rubyid_return return kw'>return</span> <span class='rubyid_just identifier id'>just</span> <span class='rubyid_one identifier id'>one</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span>
</pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>index</span>
      
      
        <span class='type'>(<tt>Range</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns a subset specified by the range.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>index</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns a subset which is belongs to the same cluster.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>index</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns just one resource.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Expo::ResourceSet (class)">ResourceSet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a ResourceSet object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 367</span>

<span class='rubyid_def def kw'>def</span> <span class='aref op'>[]</span><span class='lparen token'>(</span> <span class='rubyid_index identifier id'>index</span> <span class='rparen token'>)</span>
      <span class='rubyid_count identifier id'>count</span><span class='assign token'>=</span><span class='integer val'>0</span>
      <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
      <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span><span class='symbol val'>:node</span><span class='rparen token'>)</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_Range constant id'>Range</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_node identifier id'>node</span><span class='bitor op'>|</span>
                        <span class='rubyid_resource identifier id'>resource</span><span class='assign token'>=</span><span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='rubyid_count identifier id'>count</span> <span class='geq op'>&gt;=</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span> <span class='rparen token'>)</span> <span class='rubyid_and and kw'>and</span> <span class='lparen token'>(</span><span class='rubyid_count identifier id'>count</span> <span class='leq op'>&lt;=</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_max identifier id'>max</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
                        <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
      <span class='rubyid_end end kw'>end</span>
<span class='rubyid_if if kw'>if</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_String constant id'>String</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
<span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span><span class='symbol val'>:resource_set</span><span class='rparen token'>)</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:resource_set</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource_set identifier id'>resource_set</span><span class='bitor op'>|</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='lbrack token'>[</span><span class='symbol val'>:alias</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='rubyid_index identifier id'>index</span> <span class='rubyid_then then kw'>then</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
    <span class='rubyid_end end kw'>end</span>
      <span class='rbrace token'>}</span>
       <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
       <span class='rubyid_resource identifier id'>resource</span><span class='assign token'>=</span><span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
     <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
            <span class='rubyid_if if kw'>if</span> <span class='rubyid_count identifier id'>count</span><span class='eq op'>==</span><span class='rubyid_index identifier id'>index</span> <span class='rubyid_then then kw'>then</span>
 <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                   <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
            <span class='rubyid_end end kw'>end</span>
       <span class='rubyid_end end kw'>end</span>
           <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
       <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
      <span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="copy-instance_method">
  
    - (<tt>Object</tt>) <strong>copy</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a copy of the ResourceSet Object</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140
141
142
143
144
145</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 138</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_copy identifier id'>copy</span>
        <span class='rubyid_result identifier id'>result</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
        <span class='rubyid_result identifier id'>result</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='dot token'>.</span><span class='rubyid_replace identifier id'>replace</span><span class='lparen token'>(</span> <span class='rubyid_@properties ivar id'>@properties</span> <span class='rparen token'>)</span>
        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                <span class='rubyid_result identifier id'>result</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_copy identifier id'>copy</span> <span class='rparen token'>)</span>
        <span class='rbrace token'>}</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_result identifier id'>result</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete-instance_method">
  
    - (<tt>Object</tt>) <strong>delete</strong>(resource) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235
236
237
238
239
240
241
242
243
244
245
246
247</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 233</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='rubyid_resource identifier id'>resource</span><span class='rparen token'>)</span>
        <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each_index identifier id'>each_index</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='rubyid_i identifier id'>i</span><span class='rparen token'>)</span>
                        <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_resource identifier id'>resource</span>
                <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='comment val'>#if @resources[i].delete_all( resource ) then</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_resource identifier id'>resource</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rbrace token'>}</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_res identifier id'>res</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_first-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_first</strong>(resource) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208
209
210
211
212
213
214
215
216
217
218</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 206</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_delete_first identifier id'>delete_first</span><span class='lparen token'>(</span><span class='rubyid_resource identifier id'>resource</span><span class='rparen token'>)</span>
        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each_index identifier id'>each_index</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='rubyid_i identifier id'>i</span><span class='rparen token'>)</span>
                        <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource identifier id'>resource</span>
                <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_delete_first identifier id'>delete_first</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource identifier id'>resource</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rbrace token'>}</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_nil nil kw'>nil</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_first_if-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_first_if</strong>(&amp;block) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


220
221
222
223
224
225
226
227
228
229
230
231</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 220</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_delete_first_if identifier id'>delete_first_if</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each_index identifier id'>each_index</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_return return kw'>return</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='rubyid_i identifier id'>i</span><span class='rparen token'>)</span>
                <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_delete_first_if identifier id'>delete_first_if</span><span class='lparen token'>(</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_return return kw'>return</span> <span class='rubyid_res identifier id'>res</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rbrace token'>}</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_nil nil kw'>nil</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_if-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_if</strong>(&amp;block) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


249
250
251
252
253
254
255
256
257
258</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 249</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_delete_if identifier id'>delete_if</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each_index identifier id'>each_index</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='rubyid_i identifier id'>i</span><span class='rparen token'>)</span>
                <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_delete_if identifier id'>delete_if</span><span class='lparen token'>(</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rbrace token'>}</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each-instance_method">
  
    - (<tt>Object</tt>) <strong>each</strong>(type = nil, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Calls block once for each element in self, depending on the type of
resource. if the type is :resource_set, it is going to iterate over the
several resoruce sets defined. :node it is the default type which iterates
over all the resources defined in the resource set.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 339</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
                <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span> <span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
                <span class='rubyid_while while kw'>while</span> <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_do do kw'>do</span>
                        <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span> <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                        <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
  
  <span class='comment val'># Returns the number of resources in the ResourceSet</span>
  <span class='comment val'># @return [Integer] the number of resources</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_length identifier id'>length</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
                <span class='rubyid_count identifier id'>count</span><span class='assign token'>=</span><span class='integer val'>0</span>
                <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                        <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_count identifier id'>count</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Returns a subset of the ResourceSet.</span>
  <span class='comment val'># @note It can be used with a range as a parameter.</span>
        <span class='comment val'># @param [Range] index  Returns a subset specified by the range.</span>
        <span class='comment val'># @param [String] index Returns a subset which is belongs to the same cluster.</span>
        <span class='comment val'># @param [Integer] index  Returns just one resource.</span>
  <span class='comment val'># @return [ResourceSet]  a ResourceSet object</span>
  <span class='comment val'># @example </span>
  <span class='comment val'>#  all[1..6] extract resources from 1 to 6</span>
  <span class='comment val'>#  all[&quot;lyon&quot;] extract the resources form lyon cluster</span>
  <span class='comment val'>#    all[0]  return just one resource.</span>
        <span class='rubyid_def def kw'>def</span> <span class='aref op'>[]</span><span class='lparen token'>(</span> <span class='rubyid_index identifier id'>index</span> <span class='rparen token'>)</span>
              <span class='rubyid_count identifier id'>count</span><span class='assign token'>=</span><span class='integer val'>0</span>
              <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
              <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span><span class='symbol val'>:node</span><span class='rparen token'>)</span>
              <span class='rubyid_if if kw'>if</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_Range constant id'>Range</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_node identifier id'>node</span><span class='bitor op'>|</span>
                                <span class='rubyid_resource identifier id'>resource</span><span class='assign token'>=</span><span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='rubyid_count identifier id'>count</span> <span class='geq op'>&gt;=</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span> <span class='rparen token'>)</span> <span class='rubyid_and and kw'>and</span> <span class='lparen token'>(</span><span class='rubyid_count identifier id'>count</span> <span class='leq op'>&lt;=</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_max identifier id'>max</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                                <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                                        <span class='rubyid_end end kw'>end</span>
                                <span class='rubyid_end end kw'>end</span>
                                <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
                                <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
              <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_String constant id'>String</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
        <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span><span class='symbol val'>:resource_set</span><span class='rparen token'>)</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:resource_set</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource_set identifier id'>resource_set</span><span class='bitor op'>|</span>
            <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='lbrack token'>[</span><span class='symbol val'>:alias</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='rubyid_index identifier id'>index</span> <span class='rubyid_then then kw'>then</span>
          <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
            <span class='rubyid_end end kw'>end</span>
      <span class='rbrace token'>}</span>
       <span class='rubyid_end end kw'>end</span>
              <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
       <span class='rubyid_resource identifier id'>resource</span><span class='assign token'>=</span><span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
             <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                    <span class='rubyid_if if kw'>if</span> <span class='rubyid_count identifier id'>count</span><span class='eq op'>==</span><span class='rubyid_index identifier id'>index</span> <span class='rubyid_then then kw'>then</span>
         <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                           <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
                    <span class='rubyid_end end kw'>end</span>
       <span class='rubyid_end end kw'>end</span>
                   <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
       <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
              <span class='rbrace token'>}</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Returns a resouce or an array of resources.</span>
  <span class='comment val'># @return [Resource] a resource or array of resources</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_resource identifier id'>to_resource</span>
       <span class='rubyid_if if kw'>if</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource identifier id'>resource</span>
      <span class='rbrace token'>}</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_resource_array identifier id'>resource_array</span><span class='assign token'>=</span><span class='rubyid_Array constant id'>Array</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
        <span class='rubyid_resource_array identifier id'>resource_array</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
        <span class='rbrace token'>}</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_array identifier id'>resource_array</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_def def kw'>def</span> <span class='eq op'>==</span><span class='lparen token'>(</span> <span class='rubyid_set identifier id'>set</span> <span class='rparen token'>)</span>
                <span class='rubyid_super super kw'>super</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_@resources ivar id'>@resources</span> <span class='eq op'>==</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Equality between to resoruce sets.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_eql? fid id'>eql?</span><span class='lparen token'>(</span> <span class='rubyid_set identifier id'>set</span> <span class='rparen token'>)</span>
                <span class='rubyid_super super kw'>super</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_@resources ivar id'>@resources</span> <span class='eq op'>==</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Returns a ResourceSet with unique elements.</span>
  <span class='comment val'># @return [ResourceSet]  with unique elements</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_uniq identifier id'>uniq</span>
                <span class='rubyid_set identifier id'>set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_copy identifier id'>copy</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_uniq! fid id'>uniq!</span>
        <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_def def kw'>def</span> <span class='rubyid_uniq! fid id'>uniq!</span>
          <span class='rubyid_i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
          <span class='rubyid_while while kw'>while</span> <span class='rubyid_i identifier id'>i</span> <span class='lt op'>&lt;</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span><span class='minus op'>-</span><span class='integer val'>1</span> <span class='rubyid_do do kw'>do</span>
            <span class='rubyid_pos identifier id'>pos</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
              <span class='rubyid_for for kw'>for</span> <span class='rubyid_j identifier id'>j</span> <span class='rubyid_in in kw'>in</span> <span class='rubyid_i identifier id'>i</span><span class='plus op'>+</span><span class='float val'>1</span><span class='dot3 op'>...</span><span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span>
                                      <span class='rubyid_if if kw'>if</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_eql? fid id'>eql?</span><span class='lparen token'>(</span><span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_j identifier id'>j</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                <span class='rubyid_pos identifier id'>pos</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_j identifier id'>j</span><span class='rparen token'>)</span>
                                      <span class='rubyid_end end kw'>end</span>
                              <span class='rubyid_end end kw'>end</span>
            <span class='rubyid_pos identifier id'>pos</span><span class='dot token'>.</span><span class='rubyid_reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_p identifier id'>p</span><span class='bitor op'>|</span>
                                      <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='rubyid_p identifier id'>p</span><span class='rparen token'>)</span>
            <span class='rbrace token'>}</span>
            <span class='rubyid_i identifier id'>i</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span> <span class='plus op'>+</span> <span class='integer val'>1</span> 
                      <span class='rubyid_end end kw'>end</span>
                      <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                              <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                      <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_uniq! fid id'>uniq!</span>
                              <span class='rubyid_end end kw'>end</span>
                      <span class='rbrace token'>}</span>
                      <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Generates and return the path of the file which contains the list of the tipe of resource</span>
  <span class='comment val'>#specify by the argument type.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_resource_file identifier id'>resource_file</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_update identifier id'>update</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span> <span class='rparen token'>)</span>
                <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span> <span class='rparen token'>)</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_update identifier id'>update</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_Tempfile constant id'>Tempfile</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{type}&quot;</span><span class='rparen token'>)</span>
                        <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
                        <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                                <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='rbrack token'>]</span> <span class='rparen token'>)</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
                        <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_chmod identifier id'>chmod</span><span class='lparen token'>(</span><span class='integer val'>0644</span><span class='comma token'>,</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span><span class='rparen token'>)</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Generates and return the path of the file which contains the list  of the nodes' hostnames. Sometimes it is handy to have it.</span>
  <span class='comment val'>#eg. Use it with mpi.   </span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_node_file identifier id'>node_file</span><span class='lparen token'>(</span> <span class='rubyid_update identifier id'>update</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span> <span class='rparen token'>)</span>
                <span class='rubyid_resource_file identifier id'>resource_file</span><span class='lparen token'>(</span> <span class='symbol val'>:node</span><span class='comma token'>,</span> <span class='rubyid_update identifier id'>update</span> <span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_alias alias kw'>alias</span> <span class='rubyid_nodefile identifier id'>nodefile</span> <span class='rubyid_node_file identifier id'>node_file</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gen_keys identifier id'>gen_keys</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span> <span class='rparen token'>)</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Creating public keys for cluster ssh comunication&quot;</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_uniq identifier id'>uniq</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;scp &quot;</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;-r ~/.ssh/ &quot;</span>
      <span class='comment val'>### here we have to deal with the user ## we have to define one way to put the user.</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; root@#{resource.properties[:name]}:~&quot;</span>
      <span class='rubyid_command_result identifier id'>command_result</span> <span class='assign token'>=</span> <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_asynchronous_command identifier id'>asynchronous_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
      <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_command_wait identifier id'>command_wait</span><span class='lparen token'>(</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lbrack token'>[</span><span class='string val'>&quot;command_number&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='rubyid_result identifier id'>result</span> <span class='assign token'>=</span> <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lparen token'>(</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lbrack token'>[</span><span class='string val'>&quot;command_number&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_cmd identifier id'>cmd</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>&quot;stdout&quot;</span><span class='rbrack token'>]</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>&quot;stderr&quot;</span><span class='rbrack token'>]</span>
    <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='comment val'>#Generates a directory.xml file for using as a resources </span>
  <span class='comment val'>#For Gush.</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_make_gush_file identifier id'>make_gush_file</span><span class='lparen token'>(</span> <span class='rubyid_update identifier id'>update</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;directory.xml&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;w+&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;gush&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span> <span class='string val'>&quot;&lt;resource_manager type=\&quot;ssh\&quot;&gt;&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='dstring node'>&quot;&lt;node hostname=\&quot;#{resource.properties[:name]}:15400\&quot; user=\&quot;lig_expe\&quot; group=\&quot;local\&quot; /&gt;&quot;</span> <span class='rparen token'>)</span>

      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;/resource_manager&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rbrace token'>}</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;/gush&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Creates the taktuk command to execute on the ResourceSet</span>
  <span class='comment val'>#It takes into account if the resources are grouped under</span>
  <span class='comment val'>#different gatways in order to perform this execution more</span>
        <span class='comment val'>#efficiently.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                <span class='comment val'>#pd : séparation resource set/noeuds</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gw identifier id'>gw</span> <span class='neq op'>!=</span> <span class='string val'>&quot;localhost&quot;</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{self.gw} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='plus op'>+</span> <span class='string val'>&quot; -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_sets identifier id'>sets</span>
                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:node</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{self.gw} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='plus op'>+</span> <span class='dstring node'>&quot; downcast exec [ #{cmd} ] -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span>
                <span class='rubyid_else else kw'>else</span>
                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_first identifier id'>first</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:node</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_first identifier id'>first</span> <span class='assign token'>=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_nodes identifier id'>nodes</span>
                                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{first} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='plus op'>+</span> <span class='dstring node'>&quot; downcast exec [ #{cmd} ] -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span>
                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_sets identifier id'>sets</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span> <span class='rubyid_then then kw'>then</span> 
                                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{first} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='plus op'>+</span> <span class='string val'>&quot; -]&quot;</span>
                                <span class='rubyid_else else kw'>else</span>
                                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_str_cmd identifier id'>str_cmd</span>
        <span class='rubyid_end end kw'>end</span>

<span class='rubyid_end end kw'>end</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span>
        <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:current</span><span class='comma token'>,</span> <span class='symbol val'>:iterator</span><span class='comma token'>,</span> <span class='symbol val'>:resource_set</span><span class='comma token'>,</span> <span class='symbol val'>:type</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span> <span class='rubyid_resource_set identifier id'>resource_set</span><span class='comma token'>,</span> <span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
                <span class='rubyid_@resource_set ivar id'>@resource_set</span> <span class='assign token'>=</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
                <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                <span class='rubyid_@type ivar id'>@type</span> <span class='assign token'>=</span> <span class='rubyid_type identifier id'>type</span>
                <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
                <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_each_index identifier id'>each_index</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_@type ivar id'>@type</span> <span class='eq op'>==</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span>
                                <span class='rubyid_return return kw'>return</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_@type ivar id'>@type</span><span class='rparen token'>)</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span>
                                        <span class='rubyid_return return kw'>return</span>
                                <span class='rubyid_else else kw'>else</span>
                                        <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@type ivar id'>@type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span>
                                <span class='rubyid_return return kw'>return</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span>
        <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_def def kw'>def</span> <span class='rubyid_resource identifier id'>resource</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_nil nil kw'>nil</span> <span class='rubyid_if if_mod kw'>if</span><span class='lparen token'>(</span> <span class='rubyid_@current ivar id'>@current</span> <span class='geq op'>&gt;=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span> <span class='rparen token'>)</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                <span class='rubyid_else else kw'>else</span>
                        <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_res identifier id'>res</span>
        <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_def def kw'>def</span> <span class='rubyid_next next kw'>next</span>
                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                <span class='rubyid_@current ivar id'>@current</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@iterator ivar id'>@iterator</span>
                <span class='rubyid_while while kw'>while</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_res identifier id'>res</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_@current ivar id'>@current</span> <span class='lt op'>&lt;</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span> <span class='rubyid_do do kw'>do</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_res identifier id'>res</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                                        <span class='rubyid_@current ivar id'>@current</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@type ivar id'>@type</span> <span class='eq op'>==</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_@type ivar id'>@type</span><span class='rparen token'>)</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_res identifier id'>res</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                                        <span class='rubyid_@current ivar id'>@current</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@type ivar id'>@type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span>
                        <span class='rubyid_else else kw'>else</span>
                                <span class='rubyid_@current ivar id'>@current</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span>
        <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>

<span class='comment val'>=begin
class ResourceSet

  def +(set)
    if set.gateway then
      if set.gateway != @gateway then
         raise &quot;different gateways&quot;
      end
    end
    result = ResourceSet::new(@resources+set.resources)
    result.gateway = @gateway
    return result
  end

=end
</span>


<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_slice-instance_method">
  
    - (<tt>Object</tt>) <strong>each_slice</strong>(type = nil, slice_step = 1, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates groups of increasing size based on the slice_step paramater. This
goes until the  size of the ResourceSet.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 290</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_each_slice identifier id'>each_slice</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_slice_step identifier id'>slice_step</span> <span class='assign token'>=</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
                <span class='rubyid_i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>1</span>
                <span class='rubyid_number identifier id'>number</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
                <span class='rubyid_while while kw'>while</span> <span class='rubyid_true true kw'>true</span> <span class='rubyid_do do kw'>do</span>
                        <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
                        <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span> <span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
                        <span class='comment val'>#----is slice_step a block? if we call from</span>
                        <span class='comment val'>#----each_slice_power2 then yes</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_slice_step identifier id'>slice_step</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_Proc constant id'>Proc</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_number identifier id'>number</span> <span class='assign token'>=</span> <span class='rubyid_slice_step identifier id'>slice_step</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_i identifier id'>i</span><span class='rparen token'>)</span>

                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_slice_step identifier id'>slice_step</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_Array constant id'>Array</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                          <span class='rubyid_number identifier id'>number</span> <span class='assign token'>=</span> <span class='rubyid_slice_step identifier id'>slice_step</span><span class='dot token'>.</span><span class='rubyid_shift identifier id'>shift</span><span class='dot token'>.</span><span class='rubyid_to_i identifier id'>to_i</span>
                          <span class='rubyid_else else kw'>else</span>
                          
                                <span class='rubyid_number identifier id'>number</span> <span class='opasgn op'>+=</span> <span class='rubyid_slice_step identifier id'>slice_step</span>
                        <span class='rubyid_end end kw'>end</span>
                  
                        <span class='rubyid_return return kw'>return</span> <span class='rubyid_nil nil kw'>nil</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_number identifier id'>number</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
                        <span class='rubyid_for for kw'>for</span> <span class='rubyid_j identifier id'>j</span> <span class='rubyid_in in kw'>in</span> <span class='float val'>1</span><span class='dot2 op'>..</span><span class='rubyid_number identifier id'>number</span> <span class='rubyid_do do kw'>do</span>
                                <span class='rubyid_resource identifier id'>resource</span> <span class='assign token'>=</span> <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                                <span class='rubyid_else else kw'>else</span>
                                        <span class='rubyid_return return kw'>return</span> <span class='rubyid_nil nil kw'>nil</span>
                                <span class='rubyid_end end kw'>end</span>
                                <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
                        <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span> <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='rparen token'>)</span><span class='semicolon token'>;</span>
                        <span class='rubyid_i identifier id'>i</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
                <span class='rubyid_end end kw'>end</span> 
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Invokes the block for each set of power of two resources.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_each_slice_power2 identifier id'>each_slice_power2</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
                <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each_slice identifier id'>each_slice</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span> <span class='rubyid_i identifier id'>i</span><span class='mult op'>*</span><span class='rubyid_i identifier id'>i</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_each_slice_double identifier id'>each_slice_double</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each_slice identifier id'>each_slice</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span> <span class='integer val'>2</span><span class='pow op'>**</span><span class='rubyid_i identifier id'>i</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
        <span class='comment val'>## Fix Me  is the type really important , or were are going to deal always with nodes</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_each_slice_array identifier id'>each_slice_array</span><span class='lparen token'>(</span> <span class='rubyid_slices identifier id'>slices</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
          <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each_slice identifier id'>each_slice</span><span class='lparen token'>(</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span><span class='rubyid_slices identifier id'>slices</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Calls block once for each element in self, depending on the type of resource.</span>
  <span class='comment val'>#if the type is :resource_set, it is going to iterate over the several resoruce sets defined.</span>
  <span class='comment val'>#:node it is the default type which iterates over all the resources defined in the resource set.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
                <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span> <span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
                <span class='rubyid_while while kw'>while</span> <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_do do kw'>do</span>
                        <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span> <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                        <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
  
  <span class='comment val'># Returns the number of resources in the ResourceSet</span>
  <span class='comment val'># @return [Integer] the number of resources</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_length identifier id'>length</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
                <span class='rubyid_count identifier id'>count</span><span class='assign token'>=</span><span class='integer val'>0</span>
                <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                        <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_count identifier id'>count</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Returns a subset of the ResourceSet.</span>
  <span class='comment val'># @note It can be used with a range as a parameter.</span>
        <span class='comment val'># @param [Range] index  Returns a subset specified by the range.</span>
        <span class='comment val'># @param [String] index Returns a subset which is belongs to the same cluster.</span>
        <span class='comment val'># @param [Integer] index  Returns just one resource.</span>
  <span class='comment val'># @return [ResourceSet]  a ResourceSet object</span>
  <span class='comment val'># @example </span>
  <span class='comment val'>#  all[1..6] extract resources from 1 to 6</span>
  <span class='comment val'>#  all[&quot;lyon&quot;] extract the resources form lyon cluster</span>
  <span class='comment val'>#    all[0]  return just one resource.</span>
        <span class='rubyid_def def kw'>def</span> <span class='aref op'>[]</span><span class='lparen token'>(</span> <span class='rubyid_index identifier id'>index</span> <span class='rparen token'>)</span>
              <span class='rubyid_count identifier id'>count</span><span class='assign token'>=</span><span class='integer val'>0</span>
              <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
              <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span><span class='symbol val'>:node</span><span class='rparen token'>)</span>
              <span class='rubyid_if if kw'>if</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_Range constant id'>Range</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_node identifier id'>node</span><span class='bitor op'>|</span>
                                <span class='rubyid_resource identifier id'>resource</span><span class='assign token'>=</span><span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='rubyid_count identifier id'>count</span> <span class='geq op'>&gt;=</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span> <span class='rparen token'>)</span> <span class='rubyid_and and kw'>and</span> <span class='lparen token'>(</span><span class='rubyid_count identifier id'>count</span> <span class='leq op'>&lt;=</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_max identifier id'>max</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                                <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                                        <span class='rubyid_end end kw'>end</span>
                                <span class='rubyid_end end kw'>end</span>
                                <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
                                <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
              <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_index identifier id'>index</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_String constant id'>String</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
        <span class='rubyid_it identifier id'>it</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='comma token'>,</span><span class='symbol val'>:resource_set</span><span class='rparen token'>)</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:resource_set</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource_set identifier id'>resource_set</span><span class='bitor op'>|</span>
            <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='lbrack token'>[</span><span class='symbol val'>:alias</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='rubyid_index identifier id'>index</span> <span class='rubyid_then then kw'>then</span>
          <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
            <span class='rubyid_end end kw'>end</span>
      <span class='rbrace token'>}</span>
       <span class='rubyid_end end kw'>end</span>
              <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
       <span class='rubyid_resource identifier id'>resource</span><span class='assign token'>=</span><span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
             <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                    <span class='rubyid_if if kw'>if</span> <span class='rubyid_count identifier id'>count</span><span class='eq op'>==</span><span class='rubyid_index identifier id'>index</span> <span class='rubyid_then then kw'>then</span>
         <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
                           <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
                    <span class='rubyid_end end kw'>end</span>
       <span class='rubyid_end end kw'>end</span>
                   <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
       <span class='rubyid_it identifier id'>it</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
              <span class='rbrace token'>}</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Returns a resouce or an array of resources.</span>
  <span class='comment val'># @return [Resource] a resource or array of resources</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_resource identifier id'>to_resource</span>
       <span class='rubyid_if if kw'>if</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource identifier id'>resource</span>
      <span class='rbrace token'>}</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_resource_array identifier id'>resource_array</span><span class='assign token'>=</span><span class='rubyid_Array constant id'>Array</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
        <span class='rubyid_resource_array identifier id'>resource_array</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
        <span class='rbrace token'>}</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_array identifier id'>resource_array</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_def def kw'>def</span> <span class='eq op'>==</span><span class='lparen token'>(</span> <span class='rubyid_set identifier id'>set</span> <span class='rparen token'>)</span>
                <span class='rubyid_super super kw'>super</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_@resources ivar id'>@resources</span> <span class='eq op'>==</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Equality between to resoruce sets.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_eql? fid id'>eql?</span><span class='lparen token'>(</span> <span class='rubyid_set identifier id'>set</span> <span class='rparen token'>)</span>
                <span class='rubyid_super super kw'>super</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_@resources ivar id'>@resources</span> <span class='eq op'>==</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Returns a ResourceSet with unique elements.</span>
  <span class='comment val'># @return [ResourceSet]  with unique elements</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_uniq identifier id'>uniq</span>
                <span class='rubyid_set identifier id'>set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_copy identifier id'>copy</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_uniq! fid id'>uniq!</span>
        <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_def def kw'>def</span> <span class='rubyid_uniq! fid id'>uniq!</span>
          <span class='rubyid_i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
          <span class='rubyid_while while kw'>while</span> <span class='rubyid_i identifier id'>i</span> <span class='lt op'>&lt;</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span><span class='minus op'>-</span><span class='integer val'>1</span> <span class='rubyid_do do kw'>do</span>
            <span class='rubyid_pos identifier id'>pos</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
              <span class='rubyid_for for kw'>for</span> <span class='rubyid_j identifier id'>j</span> <span class='rubyid_in in kw'>in</span> <span class='rubyid_i identifier id'>i</span><span class='plus op'>+</span><span class='float val'>1</span><span class='dot3 op'>...</span><span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span>
                                      <span class='rubyid_if if kw'>if</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_eql? fid id'>eql?</span><span class='lparen token'>(</span><span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_j identifier id'>j</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                <span class='rubyid_pos identifier id'>pos</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_j identifier id'>j</span><span class='rparen token'>)</span>
                                      <span class='rubyid_end end kw'>end</span>
                              <span class='rubyid_end end kw'>end</span>
            <span class='rubyid_pos identifier id'>pos</span><span class='dot token'>.</span><span class='rubyid_reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_p identifier id'>p</span><span class='bitor op'>|</span>
                                      <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='rubyid_p identifier id'>p</span><span class='rparen token'>)</span>
            <span class='rbrace token'>}</span>
            <span class='rubyid_i identifier id'>i</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span> <span class='plus op'>+</span> <span class='integer val'>1</span> 
                      <span class='rubyid_end end kw'>end</span>
                      <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                              <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                      <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_uniq! fid id'>uniq!</span>
                              <span class='rubyid_end end kw'>end</span>
                      <span class='rbrace token'>}</span>
                      <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Generates and return the path of the file which contains the list of the tipe of resource</span>
  <span class='comment val'>#specify by the argument type.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_resource_file identifier id'>resource_file</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_update identifier id'>update</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span> <span class='rparen token'>)</span>
                <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span> <span class='rparen token'>)</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_update identifier id'>update</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_Tempfile constant id'>Tempfile</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{type}&quot;</span><span class='rparen token'>)</span>
                        <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
                        <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                                <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='rbrack token'>]</span> <span class='rparen token'>)</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
                        <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_chmod identifier id'>chmod</span><span class='lparen token'>(</span><span class='integer val'>0644</span><span class='comma token'>,</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span><span class='rparen token'>)</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Generates and return the path of the file which contains the list  of the nodes' hostnames. Sometimes it is handy to have it.</span>
  <span class='comment val'>#eg. Use it with mpi.   </span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_node_file identifier id'>node_file</span><span class='lparen token'>(</span> <span class='rubyid_update identifier id'>update</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span> <span class='rparen token'>)</span>
                <span class='rubyid_resource_file identifier id'>resource_file</span><span class='lparen token'>(</span> <span class='symbol val'>:node</span><span class='comma token'>,</span> <span class='rubyid_update identifier id'>update</span> <span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_alias alias kw'>alias</span> <span class='rubyid_nodefile identifier id'>nodefile</span> <span class='rubyid_node_file identifier id'>node_file</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gen_keys identifier id'>gen_keys</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span> <span class='rparen token'>)</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Creating public keys for cluster ssh comunication&quot;</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_uniq identifier id'>uniq</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;scp &quot;</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;-r ~/.ssh/ &quot;</span>
      <span class='comment val'>### here we have to deal with the user ## we have to define one way to put the user.</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; root@#{resource.properties[:name]}:~&quot;</span>
      <span class='rubyid_command_result identifier id'>command_result</span> <span class='assign token'>=</span> <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_asynchronous_command identifier id'>asynchronous_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
      <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_command_wait identifier id'>command_wait</span><span class='lparen token'>(</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lbrack token'>[</span><span class='string val'>&quot;command_number&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='rubyid_result identifier id'>result</span> <span class='assign token'>=</span> <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lparen token'>(</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lbrack token'>[</span><span class='string val'>&quot;command_number&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_cmd identifier id'>cmd</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>&quot;stdout&quot;</span><span class='rbrack token'>]</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>&quot;stderr&quot;</span><span class='rbrack token'>]</span>
    <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='comment val'>#Generates a directory.xml file for using as a resources </span>
  <span class='comment val'>#For Gush.</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_make_gush_file identifier id'>make_gush_file</span><span class='lparen token'>(</span> <span class='rubyid_update identifier id'>update</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;directory.xml&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;w+&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;gush&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span> <span class='string val'>&quot;&lt;resource_manager type=\&quot;ssh\&quot;&gt;&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='dstring node'>&quot;&lt;node hostname=\&quot;#{resource.properties[:name]}:15400\&quot; user=\&quot;lig_expe\&quot; group=\&quot;local\&quot; /&gt;&quot;</span> <span class='rparen token'>)</span>

      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;/resource_manager&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rbrace token'>}</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;/gush&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Creates the taktuk command to execute on the ResourceSet</span>
  <span class='comment val'>#It takes into account if the resources are grouped under</span>
  <span class='comment val'>#different gatways in order to perform this execution more</span>
        <span class='comment val'>#efficiently.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                <span class='comment val'>#pd : séparation resource set/noeuds</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gw identifier id'>gw</span> <span class='neq op'>!=</span> <span class='string val'>&quot;localhost&quot;</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{self.gw} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='plus op'>+</span> <span class='string val'>&quot; -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_sets identifier id'>sets</span>
                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:node</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{self.gw} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='plus op'>+</span> <span class='dstring node'>&quot; downcast exec [ #{cmd} ] -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span>
                <span class='rubyid_else else kw'>else</span>
                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_first identifier id'>first</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:node</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_first identifier id'>first</span> <span class='assign token'>=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_nodes identifier id'>nodes</span>
                                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{first} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='plus op'>+</span> <span class='dstring node'>&quot; downcast exec [ #{cmd} ] -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span>
                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_sets identifier id'>sets</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span> <span class='rubyid_then then kw'>then</span> 
                                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{first} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='plus op'>+</span> <span class='string val'>&quot; -]&quot;</span>
                                <span class='rubyid_else else kw'>else</span>
                                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_str_cmd identifier id'>str_cmd</span>
        <span class='rubyid_end end kw'>end</span>

<span class='rubyid_end end kw'>end</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span>
        <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:current</span><span class='comma token'>,</span> <span class='symbol val'>:iterator</span><span class='comma token'>,</span> <span class='symbol val'>:resource_set</span><span class='comma token'>,</span> <span class='symbol val'>:type</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span> <span class='rubyid_resource_set identifier id'>resource_set</span><span class='comma token'>,</span> <span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
                <span class='rubyid_@resource_set ivar id'>@resource_set</span> <span class='assign token'>=</span> <span class='rubyid_resource_set identifier id'>resource_set</span>
                <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                <span class='rubyid_@type ivar id'>@type</span> <span class='assign token'>=</span> <span class='rubyid_type identifier id'>type</span>
                <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
                <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_each_index identifier id'>each_index</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_@type ivar id'>@type</span> <span class='eq op'>==</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span>
                                <span class='rubyid_return return kw'>return</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_@type ivar id'>@type</span><span class='rparen token'>)</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span>
                                        <span class='rubyid_return return kw'>return</span>
                                <span class='rubyid_else else kw'>else</span>
                                        <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@type ivar id'>@type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span>
                                <span class='rubyid_return return kw'>return</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_@current ivar id'>@current</span> <span class='assign token'>=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span>
        <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_def def kw'>def</span> <span class='rubyid_resource identifier id'>resource</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_nil nil kw'>nil</span> <span class='rubyid_if if_mod kw'>if</span><span class='lparen token'>(</span> <span class='rubyid_@current ivar id'>@current</span> <span class='geq op'>&gt;=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span> <span class='rparen token'>)</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                <span class='rubyid_else else kw'>else</span>
                        <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_res identifier id'>res</span>
        <span class='rubyid_end end kw'>end</span>

        <span class='rubyid_def def kw'>def</span> <span class='rubyid_next next kw'>next</span>
                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                <span class='rubyid_@current ivar id'>@current</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@iterator ivar id'>@iterator</span>
                <span class='rubyid_while while kw'>while</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_res identifier id'>res</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_@current ivar id'>@current</span> <span class='lt op'>&lt;</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span> <span class='rubyid_do do kw'>do</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_next identifier id'>next</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_res identifier id'>res</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                                        <span class='rubyid_@current ivar id'>@current</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@type ivar id'>@type</span> <span class='eq op'>==</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSetIterator constant id'>ResourceSetIterator</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_@type ivar id'>@type</span><span class='rparen token'>)</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@iterator ivar id'>@iterator</span><span class='dot token'>.</span><span class='rubyid_resource identifier id'>resource</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_res identifier id'>res</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_@iterator ivar id'>@iterator</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
                                        <span class='rubyid_@current ivar id'>@current</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@type ivar id'>@type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_@resource_set ivar id'>@resource_set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='lbrack token'>[</span><span class='rubyid_@current ivar id'>@current</span><span class='rbrack token'>]</span>
                        <span class='rubyid_else else kw'>else</span>
                                <span class='rubyid_@current ivar id'>@current</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span>
        <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>

<span class='comment val'>=begin
class ResourceSet

  def +(set)
    if set.gateway then
      if set.gateway != @gateway then
         raise &quot;different gateways&quot;
      end
    end
    result = ResourceSet::new(@resources+set.resources)
    result.gateway = @gateway
    return result
  end

=end
</span>


<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_slice_array-instance_method">
  
    - (<tt>Object</tt>) <strong>each_slice_array</strong>(slices = 1, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Fix Me  is the type really important , or were are going to deal always
with nodes</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 332</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_each_slice_array identifier id'>each_slice_array</span><span class='lparen token'>(</span> <span class='rubyid_slices identifier id'>slices</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each_slice identifier id'>each_slice</span><span class='lparen token'>(</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span><span class='rubyid_slices identifier id'>slices</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_slice_double-instance_method">
  
    - (<tt>Object</tt>) <strong>each_slice_double</strong>(type = nil, &amp;block) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 328</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_each_slice_double identifier id'>each_slice_double</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each_slice identifier id'>each_slice</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span> <span class='integer val'>2</span><span class='pow op'>**</span><span class='rubyid_i identifier id'>i</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_slice_power2-instance_method">
  
    - (<tt>Object</tt>) <strong>each_slice_power2</strong>(type = nil, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Invokes the block for each set of power of two resources.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


324
325
326</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 324</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_each_slice_power2 identifier id'>each_slice_power2</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
        <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each_slice identifier id'>each_slice</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_i identifier id'>i</span><span class='bitor op'>|</span> <span class='rubyid_i identifier id'>i</span><span class='mult op'>*</span><span class='rubyid_i identifier id'>i</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span> <span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eql?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>eql?</strong>(set) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Equality between to resoruce sets.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


426
427
428</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 426</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_eql? fid id'>eql?</span><span class='lparen token'>(</span> <span class='rubyid_set identifier id'>set</span> <span class='rparen token'>)</span>
        <span class='rubyid_super super kw'>super</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_@resources ivar id'>@resources</span> <span class='eq op'>==</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="first-instance_method">
  
    - (<tt>Object</tt>) <strong>first</strong>(type = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the first element which is an object of the Resource Class</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


154
155
156
157
158
159
160
161
162
163
164
165
166</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 154</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_first identifier id'>first</span> <span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span> <span class='rparen token'>)</span>
        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource identifier id'>resource</span>
                <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='rparen token'>)</span>
                        <span class='rubyid_return return kw'>return</span> <span class='rubyid_res identifier id'>res</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_res identifier id'>res</span>
                <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                  <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource identifier id'>resource</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rbrace token'>}</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_nil nil kw'>nil</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flatten-instance_method">
  
    - (<tt>Object</tt>) <strong>flatten</strong>(type = nil) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='all-instance_method'>all</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Puts all the resource hierarchy into one ResourceSet. The type can be
either :node or :resource_set.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


262
263
264
265
266
267
268
269
270
271
272
273
274
275
276</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 262</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span> <span class='rparen token'>)</span>
        <span class='rubyid_set identifier id'>set</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_type identifier id'>type</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_copy identifier id'>copy</span> <span class='rparen token'>)</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_last identifier id'>last</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_clear identifier id'>clear</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_concat identifier id'>concat</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span> <span class='rparen token'>)</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rbrace token'>}</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_set identifier id'>set</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flatten!-instance_method">
  
    - (<tt>Object</tt>) <strong>flatten!</strong>(type = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


278
279
280
281
282</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 278</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_flatten! fid id'>flatten!</span> <span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span> <span class='rparen token'>)</span>
        <span class='rubyid_set identifier id'>set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_replace identifier id'>replace</span><span class='lparen token'>(</span><span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='rparen token'>)</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gen_keys-instance_method">
  
    - (<tt>Object</tt>) <strong>gen_keys</strong>(type = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 482</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_gen_keys identifier id'>gen_keys</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span> <span class='rparen token'>)</span>
  <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Creating public keys for cluster ssh comunication&quot;</span>
  <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_uniq identifier id'>uniq</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
  <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
    <span class='rubyid_cmd identifier id'>cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;scp &quot;</span>
    <span class='rubyid_cmd identifier id'>cmd</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;-r ~/.ssh/ &quot;</span>
    <span class='comment val'>### here we have to deal with the user ## we have to define one way to put the user.</span>
    <span class='rubyid_cmd identifier id'>cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; root@#{resource.properties[:name]}:~&quot;</span>
    <span class='rubyid_command_result identifier id'>command_result</span> <span class='assign token'>=</span> <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_asynchronous_command identifier id'>asynchronous_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
    <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_command_wait identifier id'>command_wait</span><span class='lparen token'>(</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lbrack token'>[</span><span class='string val'>&quot;command_number&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='rubyid_result identifier id'>result</span> <span class='assign token'>=</span> <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lparen token'>(</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lbrack token'>[</span><span class='string val'>&quot;command_number&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_cmd identifier id'>cmd</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>&quot;stdout&quot;</span><span class='rbrack token'>]</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>&quot;stderr&quot;</span><span class='rbrack token'>]</span>
  <span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="length-instance_method">
  
    - (<tt>Integer</tt>) <strong>length</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the number of resources in the ResourceSet</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the number of resources</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


349
350
351
352
353
354
355</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 349</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_length identifier id'>length</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
        <span class='rubyid_count identifier id'>count</span><span class='assign token'>=</span><span class='integer val'>0</span>
        <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                <span class='rubyid_count identifier id'>count</span><span class='opasgn op'>+=</span><span class='integer val'>1</span>
        <span class='rbrace token'>}</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_count identifier id'>count</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="make_gush_file-instance_method">
  
    - (<tt>Object</tt>) <strong>make_gush_file</strong>(update = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generates a directory.xml file for using as a resources  For Gush.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


500
501
502
503
504
505
506
507
508
509
510
511
512
513
514</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 500</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_make_gush_file identifier id'>make_gush_file</span><span class='lparen token'>(</span> <span class='rubyid_update identifier id'>update</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_gush_file identifier id'>gush_file</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;directory.xml&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;w+&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;gush&gt;&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span>
  <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span> <span class='string val'>&quot;&lt;resource_manager type=\&quot;ssh\&quot;&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='dstring node'>&quot;&lt;node hostname=\&quot;#{resource.properties[:name]}:15400\&quot; user=\&quot;lig_expe\&quot; group=\&quot;local\&quot; /&gt;&quot;</span> <span class='rparen token'>)</span>

    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;/resource_manager&gt;&quot;</span><span class='rparen token'>)</span>
  <span class='rbrace token'>}</span>
  <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;/gush&gt;&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="make_taktuk_command-instance_method">
  
    - (<tt>Object</tt>) <strong>make_taktuk_command</strong>(cmd) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates the taktuk command to execute on the ResourceSet It takes into
account if the resources are grouped under different gatways in order to
perform this execution more efficiently.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 520</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
        <span class='comment val'>#pd : séparation resource set/noeuds</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gw identifier id'>gw</span> <span class='neq op'>!=</span> <span class='string val'>&quot;localhost&quot;</span> <span class='rubyid_then then kw'>then</span>
                <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{self.gw} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='plus op'>+</span> <span class='string val'>&quot; -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_sets identifier id'>sets</span>
                <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:node</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{self.gw} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='plus op'>+</span> <span class='dstring node'>&quot; downcast exec [ #{cmd} ] -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span>
        <span class='rubyid_else else kw'>else</span>
                <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                <span class='rubyid_first identifier id'>first</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:node</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_first identifier id'>first</span> <span class='assign token'>=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_nodes identifier id'>nodes</span>
                                <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{first} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='plus op'>+</span> <span class='dstring node'>&quot; downcast exec [ #{cmd} ] -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span>
                <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_sets identifier id'>sets</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span> <span class='rubyid_then then kw'>then</span> 
                                <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{first} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='plus op'>+</span> <span class='string val'>&quot; -]&quot;</span>
                        <span class='rubyid_else else kw'>else</span>
                                <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_str_cmd identifier id'>str_cmd</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="node_file-instance_method">
  
    - (<tt>Object</tt>) <strong>node_file</strong>(update = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generates and return the path of the file which contains the list  of the
nodes’ hostnames. Sometimes it is handy to have it. eg. Use it with mpi.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


476
477
478</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 476</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_node_file identifier id'>node_file</span><span class='lparen token'>(</span> <span class='rubyid_update identifier id'>update</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span> <span class='rparen token'>)</span>
        <span class='rubyid_resource_file identifier id'>resource_file</span><span class='lparen token'>(</span> <span class='symbol val'>:node</span><span class='comma token'>,</span> <span class='rubyid_update identifier id'>update</span> <span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="push-instance_method">
  
    - (<tt>Object</tt>) <strong>push</strong>(resource) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a Resource object to the ResourceSet</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 148</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
  <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resource_file-instance_method">
  
    - (<tt>Object</tt>) <strong>resource_file</strong>(type = nil, update = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generates and return the path of the file which contains the list of the
tipe of resource specify by the argument type.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


461
462
463
464
465
466
467
468
469
470
471
472</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 461</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_resource_file identifier id'>resource_file</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_update identifier id'>update</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span> <span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span> <span class='rparen token'>)</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_update identifier id'>update</span> <span class='rubyid_then then kw'>then</span>
                <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_Tempfile constant id'>Tempfile</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{type}&quot;</span><span class='rparen token'>)</span>
                <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
                <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                        <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='rbrack token'>]</span> <span class='rparen token'>)</span>
                <span class='rbrace token'>}</span>
                <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
                <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_chmod identifier id'>chmod</span><span class='lparen token'>(</span><span class='integer val'>0644</span><span class='comma token'>,</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select-instance_method">
  
    - (<tt>Object</tt>) <strong>select</strong>(type = nil, props = nil, &amp;block) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 178</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_props identifier id'>props</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span> <span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
        <span class='rubyid_set identifier id'>set</span> <span class='assign token'>=</span> <span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_block identifier id'>block</span> <span class='rubyid_then then kw'>then</span>
                <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='dot token'>.</span><span class='rubyid_replace identifier id'>replace</span><span class='lparen token'>(</span> <span class='rubyid_@properties ivar id'>@properties</span> <span class='rparen token'>)</span>
                <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_type identifier id'>type</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_corresponds identifier id'>corresponds</span><span class='lparen token'>(</span> <span class='rubyid_props identifier id'>props</span> <span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_copy identifier id'>copy</span> <span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_type identifier id'>type</span> <span class='neq op'>!=</span> <span class='symbol val'>:resource_set</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_props identifier id'>props</span> <span class='rparen token'>)</span> <span class='rparen token'>)</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rbrace token'>}</span>
        <span class='rubyid_else else kw'>else</span>
                <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='dot token'>.</span><span class='rubyid_replace identifier id'>replace</span><span class='lparen token'>(</span> <span class='rubyid_@properties ivar id'>@properties</span> <span class='rparen token'>)</span>
                <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_type identifier id'>type</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='rubyid_type identifier id'>type</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_copy identifier id'>copy</span> <span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_type identifier id'>type</span> <span class='neq op'>!=</span> <span class='symbol val'>:resource_set</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_props identifier id'>props</span> <span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span> <span class='rparen token'>)</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rbrace token'>}</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_set identifier id'>set</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_resource-instance_method">
  
    - (<tt>Object</tt>) <strong>select_resource</strong>(props) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


168
169
170
171
172
173
174</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 168</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_select_resource identifier id'>select_resource</span><span class='lparen token'>(</span> <span class='rubyid_props identifier id'>props</span> <span class='rparen token'>)</span>
  <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_corresponds identifier id'>corresponds</span><span class='lparen token'>(</span> <span class='rubyid_props identifier id'>props</span> <span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource identifier id'>resource</span>
    <span class='rubyid_end end kw'>end</span> 
  <span class='rbrace token'>}</span>   
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_resource-instance_method">
  
    - (<tt><span class='object_link'><a href="Resource.html" title="Expo::Resource (class)">Resource</a></span></tt>) <strong>to_resource</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a resouce or an array of resources.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Resource.html" title="Expo::Resource (class)">Resource</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a resource or array of resources</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


407
408
409
410
411
412
413
414
415
416
417
418
419</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 407</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_to_resource identifier id'>to_resource</span>
     <span class='rubyid_if if kw'>if</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource identifier id'>resource</span>
    <span class='rbrace token'>}</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_resource_array identifier id'>resource_array</span><span class='assign token'>=</span><span class='rubyid_Array constant id'>Array</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
      <span class='rubyid_resource_array identifier id'>resource_array</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rparen token'>)</span>
      <span class='rbrace token'>}</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_resource_array identifier id'>resource_array</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="uniq-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Expo::ResourceSet (class)">ResourceSet</a></span></tt>) <strong>uniq</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a ResourceSet with unique elements.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Expo::ResourceSet (class)">ResourceSet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>with unique elements</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


432
433
434
435</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 432</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_uniq identifier id'>uniq</span>
        <span class='rubyid_set identifier id'>set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_copy identifier id'>copy</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_set identifier id'>set</span><span class='dot token'>.</span><span class='rubyid_uniq! fid id'>uniq!</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="uniq!-instance_method">
  
    - (<tt>Object</tt>) <strong>uniq!</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/resourceset.rb', line 437</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_uniq! fid id'>uniq!</span>
          <span class='rubyid_i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
          <span class='rubyid_while while kw'>while</span> <span class='rubyid_i identifier id'>i</span> <span class='lt op'>&lt;</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span><span class='minus op'>-</span><span class='integer val'>1</span> <span class='rubyid_do do kw'>do</span>
            <span class='rubyid_pos identifier id'>pos</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
              <span class='rubyid_for for kw'>for</span> <span class='rubyid_j identifier id'>j</span> <span class='rubyid_in in kw'>in</span> <span class='rubyid_i identifier id'>i</span><span class='plus op'>+</span><span class='float val'>1</span><span class='dot3 op'>...</span><span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span>
                                      <span class='rubyid_if if kw'>if</span> <span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_eql? fid id'>eql?</span><span class='lparen token'>(</span><span class='rubyid_@resources ivar id'>@resources</span><span class='lbrack token'>[</span><span class='rubyid_j identifier id'>j</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                <span class='rubyid_pos identifier id'>pos</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_j identifier id'>j</span><span class='rparen token'>)</span>
                                      <span class='rubyid_end end kw'>end</span>
                              <span class='rubyid_end end kw'>end</span>
            <span class='rubyid_pos identifier id'>pos</span><span class='dot token'>.</span><span class='rubyid_reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_p identifier id'>p</span><span class='bitor op'>|</span>
                                      <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='rubyid_p identifier id'>p</span><span class='rparen token'>)</span>
            <span class='rbrace token'>}</span>
            <span class='rubyid_i identifier id'>i</span> <span class='assign token'>=</span> <span class='rubyid_i identifier id'>i</span> <span class='plus op'>+</span> <span class='integer val'>1</span> 
                      <span class='rubyid_end end kw'>end</span>
                      <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                              <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                      <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_uniq! fid id'>uniq!</span>
                              <span class='rubyid_end end kw'>end</span>
                      <span class='rbrace token'>}</span>
                      <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Generates and return the path of the file which contains the list of the tipe of resource</span>
  <span class='comment val'>#specify by the argument type.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_resource_file identifier id'>resource_file</span><span class='lparen token'>(</span> <span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_update identifier id'>update</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span> <span class='rparen token'>)</span>
                <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span> <span class='rparen token'>)</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_update identifier id'>update</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_Tempfile constant id'>Tempfile</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{type}&quot;</span><span class='rparen token'>)</span>
                        <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
                        <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
                                <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span> <span class='rubyid_resource identifier id'>resource</span><span class='dot token'>.</span><span class='rubyid_properties identifier id'>properties</span><span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='rbrack token'>]</span> <span class='rparen token'>)</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
                        <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_chmod identifier id'>chmod</span><span class='lparen token'>(</span><span class='integer val'>0644</span><span class='comma token'>,</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span><span class='rparen token'>)</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='lbrack token'>[</span><span class='rubyid_type identifier id'>type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Generates and return the path of the file which contains the list  of the nodes' hostnames. Sometimes it is handy to have it.</span>
  <span class='comment val'>#eg. Use it with mpi.   </span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_node_file identifier id'>node_file</span><span class='lparen token'>(</span> <span class='rubyid_update identifier id'>update</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span> <span class='rparen token'>)</span>
                <span class='rubyid_resource_file identifier id'>resource_file</span><span class='lparen token'>(</span> <span class='symbol val'>:node</span><span class='comma token'>,</span> <span class='rubyid_update identifier id'>update</span> <span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_alias alias kw'>alias</span> <span class='rubyid_nodefile identifier id'>nodefile</span> <span class='rubyid_node_file identifier id'>node_file</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gen_keys identifier id'>gen_keys</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span> <span class='rparen token'>)</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Creating public keys for cluster ssh comunication&quot;</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_uniq identifier id'>uniq</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='rubyid_type identifier id'>type</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;scp &quot;</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;-r ~/.ssh/ &quot;</span>
      <span class='comment val'>### here we have to deal with the user ## we have to define one way to put the user.</span>
      <span class='rubyid_cmd identifier id'>cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; root@#{resource.properties[:name]}:~&quot;</span>
      <span class='rubyid_command_result identifier id'>command_result</span> <span class='assign token'>=</span> <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_asynchronous_command identifier id'>asynchronous_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
      <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_command_wait identifier id'>command_wait</span><span class='lparen token'>(</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lbrack token'>[</span><span class='string val'>&quot;command_number&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='rubyid_result identifier id'>result</span> <span class='assign token'>=</span> <span class='rubyid_$client gvar id'>$client</span><span class='dot token'>.</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lparen token'>(</span><span class='rubyid_command_result identifier id'>command_result</span><span class='lbrack token'>[</span><span class='string val'>&quot;command_number&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_cmd identifier id'>cmd</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>&quot;stdout&quot;</span><span class='rbrack token'>]</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>&quot;stderr&quot;</span><span class='rbrack token'>]</span>
    <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='comment val'>#Generates a directory.xml file for using as a resources </span>
  <span class='comment val'>#For Gush.</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_make_gush_file identifier id'>make_gush_file</span><span class='lparen token'>(</span> <span class='rubyid_update identifier id'>update</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;directory.xml&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;w+&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;gush&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flatten identifier id'>flatten</span><span class='lparen token'>(</span><span class='symbol val'>:node</span><span class='rparen token'>)</span>
    <span class='rubyid_resource_set identifier id'>resource_set</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_resource identifier id'>resource</span><span class='bitor op'>|</span>
      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span> <span class='string val'>&quot;&lt;resource_manager type=\&quot;ssh\&quot;&gt;&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='dstring node'>&quot;&lt;node hostname=\&quot;#{resource.properties[:name]}:15400\&quot; user=\&quot;lig_expe\&quot; group=\&quot;local\&quot; /&gt;&quot;</span> <span class='rparen token'>)</span>

      <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;/resource_manager&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rbrace token'>}</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;/gush&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_gush_file identifier id'>gush_file</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'>#Creates the taktuk command to execute on the ResourceSet</span>
  <span class='comment val'>#It takes into account if the resources are grouped under</span>
  <span class='comment val'>#different gatways in order to perform this execution more</span>
        <span class='comment val'>#efficiently.</span>
        <span class='rubyid_def def kw'>def</span> <span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                <span class='comment val'>#pd : séparation resource set/noeuds</span>
                <span class='rubyid_if if kw'>if</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gw identifier id'>gw</span> <span class='neq op'>!=</span> <span class='string val'>&quot;localhost&quot;</span> <span class='rubyid_then then kw'>then</span>
                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{self.gw} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='plus op'>+</span> <span class='string val'>&quot; -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_sets identifier id'>sets</span>
                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:node</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{self.gw} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='plus op'>+</span> <span class='dstring node'>&quot; downcast exec [ #{cmd} ] -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span>
                <span class='rubyid_else else kw'>else</span>
                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_first identifier id'>first</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:node</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_first identifier id'>first</span> <span class='assign token'>=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_nodes identifier id'>nodes</span>
                                        <span class='rubyid_nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{first} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_nodes_cmd identifier id'>nodes_cmd</span> <span class='plus op'>+</span> <span class='dstring node'>&quot; downcast exec [ #{cmd} ] -]&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span>
                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
                        <span class='rubyid_@resources ivar id'>@resources</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='rubyid_ResourceSet constant id'>ResourceSet</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
                                        <span class='rubyid_sets identifier id'>sets</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
                                        <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_x identifier id'>x</span><span class='dot token'>.</span><span class='rubyid_make_taktuk_command identifier id'>make_taktuk_command</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rbrace token'>}</span>
                        <span class='rubyid_if if kw'>if</span> <span class='rubyid_sets identifier id'>sets</span> <span class='rubyid_then then kw'>then</span>
                                <span class='rubyid_if if kw'>if</span> <span class='rubyid_nodes identifier id'>nodes</span> <span class='rubyid_then then kw'>then</span> 
                                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -m #{first} -[ &quot;</span> <span class='plus op'>+</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span> <span class='plus op'>+</span> <span class='string val'>&quot; -]&quot;</span>
                                <span class='rubyid_else else kw'>else</span>
                                        <span class='rubyid_str_cmd identifier id'>str_cmd</span> <span class='opasgn op'>+=</span> <span class='rubyid_sets_cmd identifier id'>sets_cmd</span>
                                <span class='rubyid_end end kw'>end</span>
                        <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_end end kw'>end</span>
                <span class='rubyid_return return kw'>return</span> <span class='rubyid_str_cmd identifier id'>str_cmd</span>
        <span class='rubyid_end end kw'>end</span>

<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Mon Nov 19 13:00:42 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.2.1 (ruby-1.8.7).
</div>

  </body>
</html>