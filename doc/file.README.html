<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.2.1
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
    <a class="full_list_link" id="tag_list_link"
        href="tag_list.html">
      Tag List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h1 id="expo-experiment-engine-for-distributed-platforms">Expo: Experiment Engine for Distributed Platforms</h1>

<p><strong>Homepage</strong>: <a href="http://expo.gforge.inria.fr">http://expo.gforge.inria.fr/</a></p>

<p><strong>Git</strong>:      <a href="https://github.com/camilo1729/expo">https://github.com/camilo1729/expo</a> </p>

<p><strong>SNV</strong>:      <a href="svn checkout svn://scm.gforge.inria.fr/svnroot/expo/">svn://scm.gforge.inria.fr/svnroot/expo/</a></p>

<p><strong>Authors</strong>:   Cristian Ruiz, Brice Videau, Olivier Richard.</p>

<p><strong>Latest Version</strong>: 0.4a (Experimental)</p>

<h2 id="synopsis">Synopsis</h2>

<p>Expo is an experiment engine for distributed platforms. It aims at simplifying the experimental process on such platforms.</p>

<ul>
  <li><a href="#features">Feature List</a></li>
  <li><a href="#GridAPI">Using Expo with Grid5000 API</a></li>
  <li><a href="#install">Installation</a></li>
  <li><a href="#Console">Getting Started with Expo Interactive Console</a></li>
  <li><a href="#contact">Contact</a></li>
  <li><a href="#publications">Related Publications</a></li>
</ul>

<p><a name="features"></a></p>

<h2 id="feature-list">Feature List</h2>

<p>Expo proposes a DSL (Domain Specific Language) derived from Ruby and adapted to the management of experiment. It is based on several abstractions like tasks, tasksets, resources and resourcesets. These abstractions, combined with the expressiveness of ruby allows for concise yet powerful experiment descriptions.</p>

<p>Expo is built from two distinct parts: a client and a server. 
The client is responsible for translating the Expo script into commands the server will execute. 
This dichotomy can help save a lot of time. 
Indeed, an experiment script containing an error might abort the client, but the commands already launched on the server, and the results gathered are not lost.
Native logging and archiving capabilities</p>

<p>In order to maximize the reproducibility and the analysis of experiments the Expo server comes with native logging capabilities. 
Standard outputs, inputs and errors are logged into memory and files. 
Those data can then be archived on disk, for longer keeping or in order to free memory. 
Start date, end date, status of each commands are also logged.</p>

<p>At the moment Expo interacts with Planetlab and Grid5000 testbeds. 
For interacting with Grid5000, Expo uses <a href="http://g5k-campaign.gforge.inria.fr/" target="_parent" title="Grid5000 campaign">Grid5000 campaign</a> 
in order to get access to the <a href="http://www.grid5000.fr/mediawiki/index.php/API" target="_parent" title="Grid5000 API">Grid5000 API</a> 
as well as the process of reserving and deploying. </p>

<p><a name="GridAPI"></a></p>

<h2 id="using-expo-with-grid5000">Using Expo with Grid5000</h2>

<p>Expo helps you to run experiments on Grid5000. With Expo you can easily:</p>

<ol>
  <li>Reserve nodes.</li>
  <li>Deploy environments.</li>
  <li>Do whatever you want with the reserved nodes.</li>
</ol>

<p>To run the simplest experiments it will be sufficient just to understand the examples presented below. However, in order to happily use all the Expo functionality you are recommended to have at least basic knowledge of <a href="http://www.grid5000.fr/mediawiki/index.php/API" target="_parent" title="Grid5000 API">Grid5000 API</a> and such tools as <a href="http://oar.imag.fr" target="_parent" title="OAR">OAR</a>, <a href="http://kadeploy3.gforge.inria.fr/" target="_parent" title="Kadeploy">Kadeploy</a> and <a href="http://taktuk.gforge.inria.fr/" target="_parent" title="Taktuk">Taktuk</a>.</p>

<p><a name="install"></a></p>

<h2 id="installing-expo">Installing Expo</h2>

<p>Expo can be run inside and outside Grid5000. For the following examples Expo is going to be installed and run inside Grid5000, from one of the chosen frontends.
As everything is going to be installed on the frontend, we need to configure gem in order to install the Expo dependencies on the user&#8217;s home directory.
Which is achieved executing:</p>

<pre class="code ruby"><code><span class='rubyid_export identifier id'>export</span> <span class='rubyid_GEM_HOME constant id'>GEM_HOME</span><span class='match op'>=~</span><span class='regexp val'>/.gem/</span> 
</code></pre>

<p>The new version of Expo uses the <a href="http://github.com/crohr/restfully" target="_parent" title="Restfully">Restfully</a> ruby gem to reserve and deploy the nodes using the Grid5000 API.</p>

<p>If the Resfully gem is not yet installed:</p>

<pre class="code ruby"><code><span class='rubyid_gem identifier id'>gem</span> <span class='rubyid_install identifier id'>install</span> <span class='rubyid_restfully identifier id'>restfully</span>
</code></pre>

<p>After installing the package a configuration file has to be created. This configuration file is used inside Grid5000. 
Outside the user and password have to be specified.</p>

<pre class="code ruby"><code>$ <span class='rubyid_echo identifier id'>echo</span> <span class='string val'>'base_uri: https://api.grid5000.fr/2.1/grid5000'</span> <span class='gt op'>&gt;</span> <span class='bitnot op'>~</span><span class='regexp val'>/.restfully/</span><span class='rubyid_api identifier id'>api</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span><span class='dot token'>.</span><span class='rubyid_yml identifier id'>yml</span> 
$ <span class='rubyid_chmod identifier id'>chmod</span> <span class='integer val'>600</span> <span class='bitnot op'>~</span><span class='regexp val'>/.restfully/</span><span class='rubyid_api identifier id'>api</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span><span class='dot token'>.</span><span class='rubyid_yml identifier id'>yml</span>
</code></pre>

<p>Expo depends on termios so it has to be installed before running Expo, install it with gem</p>

<pre class="code ruby"><code><span class='rubyid_gem identifier id'>gem</span> <span class='rubyid_install identifier id'>install</span> <span class='rubyid_termios identifier id'>termios</span>
</code></pre>

<p>One of the main functionalities of Expo is to offer an interactive console where the user can set up his/her experiment.
Because the set up of en experiment is an erro-prone task this interactive console comes in handy. 
This console is based in <a href="http://pryrepl.org" target="_parent" title="Pry">Pry</a> which offer several functionalities as syntax highlighting,
Command shell integration, allow significant user customization. To install it.</p>

<pre class="code ruby"><code><span class='rubyid_gem identifier id'>gem</span> <span class='rubyid_install identifier id'>install</span> <span class='rubyid_pry identifier id'>pry</span>
</code></pre>

<p>After that, just check out the repository through anonymous access with the following command(s).</p>

<pre class="code ruby"><code><span class='rubyid_svn identifier id'>svn</span> <span class='rubyid_checkout identifier id'>checkout</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='rubyid_username identifier id'>username</span> <span class='rubyid_anonsvn identifier id'>anonsvn</span> <span class='rubyid_https identifier id'>https</span><span class='symbol val'>:/</span><span class='regexp val'>/scm.gforge.inria.fr/s</span><span class='rubyid_vn identifier id'>vn</span><span class='div op'>/</span><span class='rubyid_expo identifier id'>expo</span><span class='div op'>/</span>
</code></pre>

<p>The password is: anonsvn.</p>

<p>or its GitHub counterpart.</p>

<pre class="code ruby"><code>   <span class='rubyid_git identifier id'>git</span> <span class='rubyid_clone identifier id'>clone</span> <span class='rubyid_https identifier id'>https</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='rubyid_camilo1729 identifier id'>camilo1729</span><span class='div op'>/</span><span class='rubyid_expo identifier id'>expo</span><span class='dot token'>.</span><span class='rubyid_git identifier id'>git</span>
</code></pre>

<p><a name="Console"></a></p>

<h2 id="getting-started-with-expo-interactive-console">Getting Started with Expo interactive Console</h2>

<h3 id="first-try">First try</h3>

<p>The first thing to do is to familiarize with Expo functionalities and syntax, to do so run expo:</p>

<pre class="code ruby"><code><span class='rubyid_$. gvar id'>$.</span><span class='div op'>/</span><span class='rubyid_expo identifier id'>expo</span>
</code></pre>

<p>You will get the following output.</p>

<pre class="code ruby"><code><span class='rubyid_ruby identifier id'>ruby</span> <span class='float val'>1.8</span><span class='integer val'>.7</span> <span class='lparen token'>(</span><span class='integer val'>2010</span><span class='minus op'>-</span><span class='integer val'>0</span><span class='integer val'>8</span><span class='minus op'>-</span><span class='integer val'>16</span> <span class='rubyid_patchlevel identifier id'>patchlevel</span> <span class='integer val'>302</span><span class='rparen token'>)</span> <span class='lbrack token'>[</span><span class='rubyid_x86_64 identifier id'>x86_64</span><span class='minus op'>-</span><span class='rubyid_linux identifier id'>linux</span><span class='rbrack token'>]</span>
<span class='rubyid_Welcome constant id'>Welcome</span> <span class='rubyid_to identifier id'>to</span> <span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Interactive constant id'>Interactive</span> <span class='rubyid_Mode constant id'>Mode</span>
<span class='rubyid_All constant id'>All</span> <span class='rubyid_the identifier id'>the</span> <span class='rubyid_libraries identifier id'>libraries</span> <span class='rubyid_have identifier id'>have</span> <span class='rubyid_been identifier id'>been</span> <span class='rubyid_loaded identifier id'>loaded</span>
<span class='rubyid_Opening constant id'>Opening</span> <span class='rubyid_Experiment constant id'>Experiment</span>
<span class='rubyid_Preparing constant id'>Preparing</span> <span class='rubyid_resource identifier id'>resource</span> <span class='rubyid_container identifier id'>container</span> <span class='rubyid_$all gvar id'>$all</span>
<span class='rubyid_Connecting constant id'>Connecting</span> <span class='rubyid_to identifier id'>to</span> <span class='rubyid_the identifier id'>the</span> <span class='rubyid_Grid5000 constant id'>Grid5000</span> <span class='rubyid_API constant id'>API</span>

<span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> 
</code></pre>

<p>After the initialization of the Console, a connection to the API is created and is it saved in the global variable &#8220;@connection&#8221;
You have to create a reservation object using this connection.</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='assign token'>=</span><span class='rubyid_ExpoEngine constant id'>ExpoEngine</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@connection ivar id'>@connection</span><span class='rparen token'>)</span>
</code></pre>

<p>The object just created has some default parameters for the reservation that can be seen with:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_defaults identifier id'>defaults</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='symbol val'>:environment</span><span class='comma token'>,</span> <span class='rubyid_nil nil kw'>nil</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
<span class='lbrack token'>[</span><span class='symbol val'>:resources</span><span class='comma token'>,</span> <span class='string val'>&quot;nodes=1&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
<span class='lbrack token'>[</span><span class='symbol val'>:site</span><span class='comma token'>,</span> <span class='string val'>&quot;rennes&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
<span class='lbrack token'>[</span><span class='symbol val'>:types</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>&quot;allow_classic_ssh&quot;</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
<span class='lbrack token'>[</span><span class='symbol val'>:walltime</span><span class='comma token'>,</span> <span class='integer val'>3600</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
<span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> 
</code></pre>

<p>A reservation can be run with those parameters by doing:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_run! fid id'>run!</span>
</code></pre>

<p>And will produce the following output:</p>

<pre class="code ruby"><code><span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>02</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>15</span><span class='symbol val'>:39</span><span class='symbol val'>:36</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_DEBUG constant id'>DEBUG</span><span class='rbrack token'>]</span> <span class='rubyid_In constant id'>In</span> <span class='div op'>/</span><span class='rubyid_home identifier id'>home</span><span class='div op'>/</span><span class='rubyid_cruizsanabria identifier id'>cruizsanabria</span><span class='div op'>/</span><span class='rubyid_Repositories constant id'>Repositories</span><span class='div op'>/</span><span class='rubyid_git identifier id'>git</span><span class='div op'>/</span><span class='rubyid_expo identifier id'>expo</span><span class='div op'>/</span><span class='rubyid_bin identifier id'>bin</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>02</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>15</span><span class='symbol val'>:39</span><span class='symbol val'>:36</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Engine constant id'>Engine</span> <span class='rubyid_Grid5000 constant id'>Grid5000</span> <span class='rubyid_API constant id'>API</span> <span class='rbrack token'>]</span> <span class='rubyid_Asking constant id'>Asking</span> <span class='rubyid_for for kw'>for</span> <span class='rubyid_Resources constant id'>Resources</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>02</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>15</span><span class='symbol val'>:39</span><span class='symbol val'>:36</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Engine constant id'>Engine</span> <span class='rubyid_Grid5000 constant id'>Grid5000</span> <span class='rubyid_API constant id'>API</span> <span class='rbrack token'>]</span> <span class='rubyid_Number constant id'>Number</span> <span class='rubyid_of identifier id'>of</span> <span class='rubyid_nodes identifier id'>nodes</span> <span class='rubyid_to identifier id'>to</span> <span class='rubyid_reserve identifier id'>reserve</span> <span class='rubyid_in in kw'>in</span> <span class='rubyid_site identifier id'>site</span><span class='colon op'>:</span> <span class='rubyid_grenoble identifier id'>grenoble</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_nodes identifier id'>nodes</span><span class='assign token'>=</span><span class='integer val'>1</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>02</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>15</span><span class='symbol val'>:39</span><span class='symbol val'>:36</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='rubyid_grenoble identifier id'>grenoble</span><span class='rbrack token'>]</span> <span class='rubyid_Launching constant id'>Launching</span> <span class='rubyid_job identifier id'>job</span> <span class='lbrack token'>[</span><span class='rubyid_no identifier id'>no</span><span class='minus op'>-</span><span class='rubyid_submit identifier id'>submit</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span><span class='rbrack token'>]</span><span class='dot3 op'>...</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>02</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>15</span><span class='symbol val'>:39</span><span class='symbol val'>:47</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='rubyid_grenoble identifier id'>grenoble</span><span class='rbrack token'>]</span> <span class='rubyid_Got constant id'>Got</span> <span class='rubyid_the identifier id'>the</span> <span class='rubyid_following identifier id'>following</span> <span class='rubyid_job identifier id'>job</span><span class='colon op'>:</span> <span class='integer val'>1391958</span> 
</code></pre>

<p>You have to wait till the reservation take place:</p>

<pre class="code ruby"><code><span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>02</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>15</span><span class='symbol val'>:42</span><span class='symbol val'>:53</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='rubyid_grenoble identifier id'>grenoble</span><span class='rbrack token'>]</span> <span class='rubyid_Job constant id'>Job</span> <span class='rubyid_is identifier id'>is</span> <span class='rubyid_running identifier id'>running</span><span class='colon op'>:</span>
</code></pre>

<p>The next step is to take a look at the variable $all automatically filled with the reserved resources description.
It looks something like this:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_$all gvar id'>$all</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='comment val'>#&lt;Expo::ResourceSet:0x7f39774d8f20</span>
<span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
<span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
<span class='rubyid_@resources ivar id'>@resources</span><span class='assign token'>=</span>
<span class='lbrack token'>[</span><span class='comment val'>#&lt;Expo::ResourceSet:0x7f397712e960</span>
  <span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span>
  <span class='lbrace token'>{</span><span class='symbol val'>:alias</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;borderline&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:gateway=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;frontend.bordeaux.grid5000.fr&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:site=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;bordeaux&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;ExpoEngine&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:id=</span><span class='gt op'>&gt;</span><span class='integer val'>948835</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
  <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
  <span class='rubyid_@resources ivar id'>@resources</span><span class='assign token'>=</span>
  <span class='lbrack token'>[</span><span class='comment val'>#&lt;Expo::Resource:0x7f397712e708</span>
       <span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span>
    <span class='lbrace token'>{</span><span class='symbol val'>:gateway=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;frontend.bordeaux.grid5000.fr&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:site=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;bordeaux&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;borderline-9.bordeaux.grid5000.fr&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
      <span class='rubyid_@type ivar id'>@type</span><span class='assign token'>=</span><span class='symbol val'>:node</span><span class='gt op'>&gt;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='rubyid_@type ivar id'>@type</span><span class='assign token'>=</span><span class='symbol val'>:resource_set</span><span class='gt op'>&gt;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
<span class='rubyid_@type ivar id'>@type</span><span class='assign token'>=</span><span class='symbol val'>:resource_set</span><span class='gt op'>&gt;</span>
</code></pre>

<p>This $all variable is an object from the Class &#8220;Resource_set&#8221;,
which helps the user to keep track of the resources reserved with its hierarchical structure
and some important related information. This Class has some special methods and operators.
For example in order to know how many resources were reserved:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_$all gvar id'>$all</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span>
</code></pre>

<p>We see that resources are grouped by cluster and have some properties like the number of the job that generated it, 
the site , the gateway ( Important for executing commands with TakTuk), etc.
We are going to see more characteristic of this &#8220;Resource_Set&#8221; Class with more examples.
What if we want to execute something on this resource reserved, it is easy with Expo.
Execute the command &#8220;hostname&#8221; on a remote host:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_task identifier id'>task</span> <span class='rubyid_$all gvar id'>$all</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span><span class='comma token'>,</span> <span class='string val'>&quot;hostname&quot;</span>
<span class='rubyid_borderline identifier id'>borderline</span><span class='minus op'>-</span><span class='float val'>9</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>18</span><span class='symbol val'>:54</span><span class='symbol val'>:41</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Sequential constant id'>Sequential</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:0</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Executed constant id'>Executed</span> <span class='rbrack token'>]</span>   <span class='rubyid_hostname identifier id'>hostname</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>18</span><span class='symbol val'>:54</span><span class='symbol val'>:41</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Sequential constant id'>Sequential</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:0</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_On constant id'>On</span> <span class='rubyid_Node constant id'>Node</span> <span class='rbrack token'>]</span>  <span class='rubyid_borderline identifier id'>borderline</span><span class='minus op'>-</span><span class='float val'>9</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>18</span><span class='symbol val'>:54</span><span class='symbol val'>:41</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Sequential constant id'>Sequential</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:0</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Elapsed constant id'>Elapsed</span> <span class='rubyid_Time constant id'>Time</span> <span class='rbrack token'>]</span> <span class='integer val'>0</span><span class='integer val'>.00496</span> <span class='rubyid_secs identifier id'>secs</span> 
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span>
<span class='lbrack token'>[</span><span class='lbrace token'>{</span><span class='string val'>&quot;stdout&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;borderline-9.bordeaux.grid5000.fr\n&quot;</span><span class='comma token'>,</span>
<span class='string val'>&quot;end_time&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='rubyid_Sun constant id'>Sun</span> <span class='rubyid_Nov constant id'>Nov</span> <span class='integer val'>18</span> <span class='integer val'>18</span><span class='symbol val'>:54</span><span class='symbol val'>:41</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='integer val'>2012</span><span class='comma token'>,</span>
<span class='string val'>&quot;host_name&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;borderline-9.bordeaux.grid5000.fr&quot;</span><span class='comma token'>,</span>
<span class='string val'>&quot;stderr&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
<span class='string val'>&quot;rank&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;1&quot;</span><span class='comma token'>,</span>
<span class='string val'>&quot;status&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0&quot;</span><span class='comma token'>,</span>
<span class='string val'>&quot;command_line&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;cd . ; hostname &quot;</span><span class='comma token'>,</span>
<span class='string val'>&quot;start_time&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='rubyid_Sun constant id'>Sun</span> <span class='rubyid_Nov constant id'>Nov</span> <span class='integer val'>18</span> <span class='integer val'>18</span><span class='symbol val'>:54</span><span class='symbol val'>:41</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='integer val'>2012</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
</code></pre>

<p>This command returns the id of the task executed and 
a special Hash that is called &#8220;ExpoResult&#8221; containing information about the execution such as: start time, end time, host used, command executed, etc.
We can keep this information in a variable doing:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_id identifier id'>id</span><span class='comma token'>,</span> <span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span><span class='rubyid_task identifier id'>task</span> <span class='rubyid_$all gvar id'>$all</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span><span class='comma token'>,</span> <span class='string val'>&quot;hostname&quot;</span>
</code></pre>

<p>And explore each one of the values.</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_res identifier id'>res</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'stdout'</span><span class='rbrack token'>]</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;borderline-9.bordeaux.grid5000.fr&quot;</span>
</code></pre>

<p>As well as calculating the time it took to execute the command:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_res identifier id'>res</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_duration identifier id'>duration</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='integer val'>.00495</span>
</code></pre>

<p>If we want to free the resources we execute:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_stop! fid id'>stop!</span>
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>19</span><span class='symbol val'>:14</span><span class='symbol val'>:01</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='rubyid_Cleaning constant id'>Cleaning</span> <span class='rubyid_up identifier id'>up</span> <span class='rubyid_all identifier id'>all</span> <span class='rubyid_jobs identifier id'>jobs</span> <span class='rubyid_and and kw'>and</span> <span class='rubyid_deployments identifier id'>deployments</span><span class='dot3 op'>...</span> 
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='comment val'>#&lt;Expo::ResourceSet:0x7f39774cca18</span>
<span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
<span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
<span class='rubyid_@resources ivar id'>@resources</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
<span class='rubyid_@type ivar id'>@type</span><span class='assign token'>=</span><span class='symbol val'>:resource_set</span><span class='gt op'>&gt;</span>
</code></pre>

<p>This will clean the environment and will delete any job submitted.
All the activity is logged into two files: </p>

<ul>
  <li>Expo_log_(time stamp).log</li>
  <li>Expo_data_log_(time stamp).log</li>
</ul>

<p>The first one logs information about the principal events and the second one keeps track of all the data structures produced.
It is a more detailed log.</p>

<p>Now that we know the basics of Expo let&#8217;s move further.</p>

<h3 id="simple-example-with-several-machines">Simple example with several machines.</h3>

<p>Let&#8217;s use several machines, and see what Expo has to offer.
So go into the expo console and create the reservation object as seen in the previous section.
Here again:</p>

<pre class="code ruby"><code> <span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='assign token'>=</span><span class='rubyid_ExpoEngine constant id'>ExpoEngine</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@connection ivar id'>@connection</span><span class='rparen token'>)</span>
</code></pre>

<p>And now let&#8217;s change some parameters of the reservation, choose several machines in bordeaux site:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_site identifier id'>site</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='string val'>&quot;bordeaux&quot;</span><span class='rbrack token'>]</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;bordeaux&quot;</span><span class='rbrack token'>]</span>
<span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='string val'>&quot;nodes=10&quot;</span><span class='rbrack token'>]</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;nodes=10&quot;</span><span class='rbrack token'>]</span>
<span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_walltime identifier id'>walltime</span><span class='assign token'>=</span><span class='integer val'>600</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>600</span>
</code></pre>

<p>We run the reservation:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_run! fid id'>run!</span>
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>19</span><span class='symbol val'>:42</span><span class='symbol val'>:35</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_DEBUG constant id'>DEBUG</span><span class='rbrack token'>]</span> <span class='rubyid_In constant id'>In</span> <span class='div op'>/</span><span class='rubyid_home identifier id'>home</span><span class='div op'>/</span><span class='rubyid_cruizsanabria identifier id'>cruizsanabria</span><span class='div op'>/</span><span class='rubyid_Repositories constant id'>Repositories</span><span class='div op'>/</span><span class='rubyid_git identifier id'>git</span><span class='div op'>/</span><span class='rubyid_expo identifier id'>expo</span><span class='div op'>/</span><span class='rubyid_bin identifier id'>bin</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>19</span><span class='symbol val'>:42</span><span class='symbol val'>:35</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Engine constant id'>Engine</span> <span class='rubyid_Grid5000 constant id'>Grid5000</span> <span class='rubyid_API constant id'>API</span> <span class='rbrack token'>]</span> <span class='rubyid_Asking constant id'>Asking</span> <span class='rubyid_for for kw'>for</span> <span class='rubyid_Resources constant id'>Resources</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>19</span><span class='symbol val'>:42</span><span class='symbol val'>:35</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Engine constant id'>Engine</span> <span class='rubyid_Grid5000 constant id'>Grid5000</span> <span class='rubyid_API constant id'>API</span> <span class='rbrack token'>]</span> <span class='rubyid_Number constant id'>Number</span> <span class='rubyid_of identifier id'>of</span> <span class='rubyid_nodes identifier id'>nodes</span> <span class='rubyid_to identifier id'>to</span> <span class='rubyid_reserve identifier id'>reserve</span> <span class='rubyid_in in kw'>in</span> <span class='rubyid_site identifier id'>site</span><span class='colon op'>:</span> <span class='rubyid_bordeaux identifier id'>bordeaux</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_nodes identifier id'>nodes</span><span class='assign token'>=</span><span class='integer val'>10</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>19</span><span class='symbol val'>:42</span><span class='symbol val'>:35</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='rbrack token'>]</span> <span class='rubyid_Launching constant id'>Launching</span> <span class='rubyid_job identifier id'>job</span> <span class='lbrack token'>[</span><span class='rubyid_no identifier id'>no</span><span class='minus op'>-</span><span class='rubyid_submit identifier id'>submit</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span><span class='rbrack token'>]</span><span class='dot3 op'>...</span> 
</code></pre>

<p>After waiting few minutes we got the job.</p>

<pre class="code ruby"><code> <span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>19</span><span class='symbol val'>:42</span><span class='symbol val'>:45</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='rbrack token'>]</span> <span class='rubyid_Got constant id'>Got</span> <span class='rubyid_the identifier id'>the</span> <span class='rubyid_following identifier id'>following</span> <span class='rubyid_job identifier id'>job</span><span class='colon op'>:</span> <span class='integer val'>948839</span> 
 <span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>19</span><span class='symbol val'>:42</span><span class='symbol val'>:55</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='rbrack token'>]</span> <span class='rubyid_Job constant id'>Job</span> <span class='rubyid_is identifier id'>is</span> <span class='rubyid_running identifier id'>running</span><span class='colon op'>:</span> 
</code></pre>

<p>If we take a look at the Resource_set it should look something like this:</p>

<pre class="code ruby"><code> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='comment val'>#&lt;Expo::ResourceSet:0x7f1cbd9fdf40</span>
 <span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
 <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
 <span class='rubyid_@resources ivar id'>@resources</span><span class='assign token'>=</span>
<span class='lbrack token'>[</span><span class='comment val'>#&lt;Expo::ResourceSet:0x7f1cbb0f6228</span>
  <span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span>
    <span class='lbrace token'>{</span><span class='symbol val'>:alias</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;borderline&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:gateway=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;frontend.bordeaux.grid5000.fr&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:site=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;bordeaux&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;ExpoEngine&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:id=</span><span class='gt op'>&gt;</span><span class='integer val'>948839</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='rubyid_@resource_files ivar id'>@resource_files</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='rubyid_@resources ivar id'>@resources</span><span class='assign token'>=</span>
  <span class='lbrack token'>[</span><span class='comment val'>#&lt;Expo::Resource:0x7f1cbb0f5940</span>
  <span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span>
    <span class='lbrace token'>{</span><span class='symbol val'>:gateway=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;frontend.bordeaux.grid5000.fr&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:site=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;bordeaux&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;borderline-1.bordeaux.grid5000.fr&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
      <span class='rubyid_@type ivar id'>@type</span><span class='assign token'>=</span><span class='symbol val'>:node</span><span class='gt op'>&gt;</span><span class='comma token'>,</span>
    <span class='comment val'>#&lt;Expo::Resource:0x7f1cbb0f5828</span>
  <span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span>
    <span class='lbrace token'>{</span><span class='symbol val'>:gateway=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;frontend.bordeaux.grid5000.fr&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:site=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;bordeaux&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;borderline-2.bordeaux.grid5000.fr&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
      <span class='rubyid_@type ivar id'>@type</span><span class='assign token'>=</span><span class='symbol val'>:node</span><span class='gt op'>&gt;</span><span class='comma token'>,</span>
    <span class='comment val'>#&lt;Expo::Resource:0x7f1cbb0f51e8</span>
  <span class='rubyid_@properties ivar id'>@properties</span><span class='assign token'>=</span>
    <span class='lbrace token'>{</span><span class='symbol val'>:gateway=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;frontend.bordeaux.grid5000.fr&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:site=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;bordeaux&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;borderline-3.bordeaux.grid5000.fr&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
</code></pre>

<p>The output was chopped off because its long. Here we got resources from two different clusters:</p>

<p>we can print the hostnames of the nodes per cluster:</p>

<pre class="code ruby"><code> <span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_$all gvar id'>$all</span><span class='lbrack token'>[</span><span class='string val'>&quot;borderline&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_node identifier id'>node</span><span class='bitor op'>|</span> <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_node identifier id'>node</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span><span class='rbrace token'>}</span>
 <span class='rubyid_borderline identifier id'>borderline</span><span class='minus op'>-</span><span class='float val'>1</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='rubyid_borderline identifier id'>borderline</span><span class='minus op'>-</span><span class='float val'>2</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='rubyid_borderline identifier id'>borderline</span><span class='minus op'>-</span><span class='float val'>3</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_nil nil kw'>nil</span>
</code></pre>

<p>For the other cluster:</p>

<pre class="code ruby"><code> <span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_$all gvar id'>$all</span><span class='lbrack token'>[</span><span class='string val'>&quot;bordereau&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_node identifier id'>node</span><span class='bitor op'>|</span> <span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_node identifier id'>node</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span><span class='rbrace token'>}</span>
 <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>9</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>84</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>85</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>86</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>90</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>91</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
 <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>92</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
</code></pre>

<p>Therefore, we got 3 nodes in cluster &#8220;bordereau&#8221; and 7 in &#8220;borderline&#8221;.
But well the interesting thing is to execute commands in those machines. 
We simply use ptask ( Paralle task).</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_ptask identifier id'>ptask</span> <span class='rubyid_$all gvar id'>$all</span><span class='comma token'>,</span> <span class='string val'>&quot;hostname&quot;</span>
<span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>84</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Executed constant id'>Executed</span> <span class='rbrack token'>]</span>   <span class='rubyid_hostname identifier id'>hostname</span>
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_On constant id'>On</span> <span class='rubyid_Node constant id'>Node</span> <span class='rbrack token'>]</span>  <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>84</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Elapsed constant id'>Elapsed</span> <span class='rubyid_Time constant id'>Time</span> <span class='rbrack token'>]</span> <span class='integer val'>0</span><span class='integer val'>.0049</span> <span class='rubyid_secs identifier id'>secs</span>
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Executed constant id'>Executed</span> <span class='rbrack token'>]</span>   <span class='rubyid_hostname identifier id'>hostname</span>      
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_On constant id'>On</span> <span class='rubyid_Node constant id'>Node</span> <span class='rbrack token'>]</span>  <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>92</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Elapsed constant id'>Elapsed</span> <span class='rubyid_Time constant id'>Time</span> <span class='rbrack token'>]</span> <span class='integer val'>0</span><span class='integer val'>.0047</span> <span class='rubyid_secs identifier id'>secs</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Executed constant id'>Executed</span> <span class='rbrack token'>]</span>   <span class='rubyid_hostname identifier id'>hostname</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_On constant id'>On</span> <span class='rubyid_Node constant id'>Node</span> <span class='rbrack token'>]</span>  <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>85</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Elapsed constant id'>Elapsed</span> <span class='rubyid_Time constant id'>Time</span> <span class='rbrack token'>]</span> <span class='integer val'>0</span><span class='integer val'>.00468</span> <span class='rubyid_secs identifier id'>secs</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Executed constant id'>Executed</span> <span class='rbrack token'>]</span>   <span class='rubyid_hostname identifier id'>hostname</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_On constant id'>On</span> <span class='rubyid_Node constant id'>Node</span> <span class='rbrack token'>]</span>  <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>86</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Elapsed constant id'>Elapsed</span> <span class='rubyid_Time constant id'>Time</span> <span class='rbrack token'>]</span> <span class='integer val'>0</span><span class='integer val'>.00462</span> <span class='rubyid_secs identifier id'>secs</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Executed constant id'>Executed</span> <span class='rbrack token'>]</span>   <span class='rubyid_hostname identifier id'>hostname</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_On constant id'>On</span> <span class='rubyid_Node constant id'>Node</span> <span class='rbrack token'>]</span>  <span class='rubyid_bordereau identifier id'>bordereau</span><span class='minus op'>-</span><span class='float val'>90</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Elapsed constant id'>Elapsed</span> <span class='rubyid_Time constant id'>Time</span> <span class='rbrack token'>]</span> <span class='integer val'>0</span><span class='integer val'>.00508</span> <span class='rubyid_secs identifier id'>secs</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Executed constant id'>Executed</span> <span class='rbrack token'>]</span>   <span class='rubyid_hostname identifier id'>hostname</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_On constant id'>On</span> <span class='rubyid_Node constant id'>Node</span> <span class='rbrack token'>]</span>  <span class='rubyid_borderline identifier id'>borderline</span><span class='minus op'>-</span><span class='float val'>1</span><span class='dot token'>.</span><span class='rubyid_bordeaux identifier id'>bordeaux</span><span class='dot token'>.</span><span class='rubyid_grid5000 identifier id'>grid5000</span><span class='dot token'>.</span><span class='rubyid_fr identifier id'>fr</span>  
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Elapsed constant id'>Elapsed</span> <span class='rubyid_Time constant id'>Time</span> <span class='rbrack token'>]</span> <span class='integer val'>0</span><span class='integer val'>.00527</span> <span class='rubyid_secs identifier id'>secs</span> 
<span class='integer val'>2012</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>18</span> <span class='integer val'>20</span><span class='symbol val'>:02</span><span class='symbol val'>:32</span> <span class='plus op'>+</span><span class='integer val'>0100</span> <span class='lbrack token'>[</span><span class='rubyid_INFO constant id'>INFO</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span> <span class='rubyid_Parallel constant id'>Parallel</span> <span class='rubyid_Task constant id'>Task</span><span class='symbol val'>:4</span> <span class='rbrack token'>]</span>  <span class='lbrack token'>[</span> <span class='rubyid_Executed constant id'>Executed</span> <span class='rbrack token'>]</span>   <span class='rubyid_hostname identifier id'>hostname</span>  
</code></pre>

<p>We can separate the resources of the two clusters and execute commands over them:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_id identifier id'>id</span><span class='comma token'>,</span> <span class='rubyid_res_bordereau identifier id'>res_bordereau</span> <span class='assign token'>=</span><span class='rubyid_ptask identifier id'>ptask</span> <span class='rubyid_$all gvar id'>$all</span><span class='lbrack token'>[</span><span class='string val'>&quot;bordereau&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>&quot;hostname&quot;</span>
<span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_id identifier id'>id</span><span class='comma token'>,</span> <span class='rubyid_res_borderline identifier id'>res_borderline</span> <span class='assign token'>=</span><span class='rubyid_ptask identifier id'>ptask</span> <span class='rubyid_$all gvar id'>$all</span><span class='lbrack token'>[</span><span class='string val'>&quot;borderline&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>&quot;hostname&quot;</span>
</code></pre>

<p>And compare their execution times:</p>

<pre class="code ruby"><code><span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_res_borderline identifier id'>res_borderline</span><span class='dot token'>.</span><span class='rubyid_duration identifier id'>duration</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='integer val'>.01201</span>
<span class='rubyid_Expo constant id'>Expo</span> <span class='rubyid_Console constant id'>Console</span> <span class='gt op'>&gt;</span> <span class='rubyid_res_bordereau identifier id'>res_bordereau</span><span class='dot token'>.</span><span class='rubyid_duration identifier id'>duration</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='integer val'>.00751</span>
</code></pre>

<h2 id="writing-everthing-into-an-experiment-description-file">Writing everthing into an Experiment Description File</h2>

<p>The aim of the console is to try different commands that after will make part of an experiment.
Everything will be run without human intervention.
Let&#8217;s write an experiment description file, which is mainly a ruby script but that has the support of
Expo&#8217;s abstractions and Logging capabilities.</p>

<pre class="code ruby"><code><span class='rubyid_reserv identifier id'>reserv</span><span class='assign token'>=</span><span class='rubyid_ExpoEngine constant id'>ExpoEngine</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@connection ivar id'>@connection</span><span class='rparen token'>)</span>
<span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_site identifier id'>site</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='string val'>&quot;bordeaux&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;lille&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;luxembourg&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;nancy&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;sophia&quot;</span><span class='rbrack token'>]</span>
<span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_resources identifier id'>resources</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='string val'>&quot;nodes=50&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;nodes=10&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;nodes=4&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;nodes=4&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;nodes=30&quot;</span><span class='rbrack token'>]</span>
<span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span> <span class='assign token'>=</span> <span class='string val'>&quot;Expo Scalability&quot;</span>
<span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_walltime identifier id'>walltime</span><span class='assign token'>=</span><span class='integer val'>600</span>

<span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_run! fid id'>run!</span>

<span class='rubyid_sizes identifier id'>sizes</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='integer val'>10</span><span class='comma token'>,</span><span class='integer val'>20</span><span class='comma token'>,</span><span class='integer val'>40</span><span class='comma token'>,</span><span class='integer val'>50</span><span class='comma token'>,</span><span class='integer val'>80</span><span class='comma token'>,</span><span class='rubyid_$all gvar id'>$all</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='rbrack token'>]</span>

<span class='rubyid_$all gvar id'>$all</span><span class='dot token'>.</span><span class='rubyid_each_slice_array identifier id'>each_slice_array</span><span class='lparen token'>(</span><span class='rubyid_sizes identifier id'>sizes</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span> <span class='rubyid_nodes identifier id'>nodes</span><span class='bitor op'>|</span>
      
  <span class='rubyid_task_mon identifier id'>task_mon</span><span class='assign token'>=</span> <span class='rubyid_Task constant id'>Task</span><span class='colon2 op'>::</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;hostname&quot;</span><span class='comma token'>,</span><span class='rubyid_nodes identifier id'>nodes</span><span class='comma token'>,</span><span class='dstring node'>&quot; Monitoring #{nodes.length} nodes&quot;</span><span class='rparen token'>)</span>
  <span class='lparen token'>(</span><span class='integer val'>10</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_times identifier id'>times</span><span class='lbrace token'>{</span>
  
    <span class='rubyid_id identifier id'>id</span><span class='comma token'>,</span><span class='rubyid_res identifier id'>res</span> <span class='assign token'>=</span> <span class='rubyid_task_mon identifier id'>task_mon</span><span class='dot token'>.</span><span class='rubyid_execute identifier id'>execute</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot; #{res.length} : #{res.duration}&quot;</span>
      
  <span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>

<span class='rubyid_reserv identifier id'>reserv</span><span class='dot token'>.</span><span class='rubyid_stop! fid id'>stop!</span>
</code></pre>

<p>The experiment here is about executing the linux command &#8220;hostname&#8221; over different sets of machines,
doing 10 tries per set of machines and after printing the results: how many machines have responded and the duration of the total execution.
In this file were introduced new functionalities, the method <strong>each_slice_array</strong>,     	
Which creates slices of sizes specified in the array.
These slices are used to try with different sets of machines 
which is quite done in testing scalability for a giving software.
The Object <strong>Task</strong> which is a cleaner way of executing parallel commands specially if
we do it several times, it gives more readability to the code
This object offers several possibilities and can be used in conjunction with other objects 
that are going to be presented later on.</p>

<h2 id="expo-data">Expo Data</h2>

<h3 id="list-of-expo-engine-reservation-parameters">List of Expo Engine reservation parameters</h3>

<p>These are Grid5000 campaign specific.</p>

<ul>
  <li><strong>:site =&gt; [&#8220;lille&#8221;, &#8220;grenoble&#8221;, &#8230;]</strong>          reserve on specific sites
<strong>:site =&gt; &#8220;all&#8221;</strong>                               reserve on all Grid5000 sites
<strong>:site =&gt; &#8220;any&#8221;</strong>                               reserve on a site with the max number of available nodes</li>
  <li><strong>:resources =&gt; [&#8220;nodes=1&#8221;, &#8220;nodes=5&#8221;]</strong>         reserve one node on the first site from :site, 5 nodes on the second site
<strong>:resources =&gt; [&#8220;cluster=2/nodes=3&#8221;]</strong>          reserve 3 nodes in 2 different clusters
<strong>:resources =&gt; [&#8220;and memcpu=8192/nodes=2&#8221;]</strong>   reserve 2 nodes with properties</li>
  <li><strong>:environment =&gt; =&gt; 2</strong>                 deploy env1 environment on the first 2 nodes from resources array
<strong>:environment =&gt; =&gt; 1, &#8220;env2&#8221; =&gt; 2</strong>    deploy env1 on the first node and env2 on the second and third nodes</li>
  <li><strong>:walltime =&gt; 1800</strong></li>
  <li><strong>:types =&gt; [&#8220;besteffort&#8221;]</strong>                      specify reservation type to &#8220;besteffort&#8221;.</li>
  <li><strong>:name =&gt; &#8220;experiment_name&#8221;</strong>                    the name of your experiment</li>
  <li><strong>:no_cleanup =&gt; false</strong>                          specifies if the experiment will be deleted after the Expo returns</li>
  <li><strong>:deployment_max_attempts =&gt; 1</strong>                 how many times we want to redeploy a node if the deployment fails</li>
  <li><strong>:submission_timeout =&gt; 5*60</strong>                   for how long we wait for the reservation to be finished</li>
  <li><strong>:deployment_timeout =&gt; 15*60</strong>                  for how long we wait for the deployment to be finished</li>
</ul>

<p>The default values are:</p>

<pre class="code ruby"><code><span class='symbol val'>:site</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> \<span class='lbrack token'>[</span><span class='string val'>&quot;rennes&quot;</span>\<span class='rbrack token'>]</span>
<span class='symbol val'>:resources</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> \<span class='lbrack token'>[</span><span class='string val'>&quot;nodes=1&quot;</span>\<span class='rbrack token'>]</span>
<span class='symbol val'>:environment</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_nil nil kw'>nil</span>
<span class='symbol val'>:walltime</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>3600</span>
<span class='symbol val'>:types</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> \<span class='lbrack token'>[</span><span class='string val'>&quot;allow_classic_ssh&quot;</span>\<span class='rbrack token'>]</span>
<span class='symbol val'>:no_cleanup</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_false false kw'>false</span>
<span class='symbol val'>:deployment_max_attempts</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span> <span class='gt op'>&gt;</span>
<span class='symbol val'>:submission_timeout</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>5</span><span class='mult op'>*</span><span class='integer val'>60</span>
<span class='symbol val'>:deployment_timeout</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>15</span><span class='mult op'>*</span><span class='integer val'>60</span>
</code></pre>

<h3 id="expo-commands-and-global-variables">Expo commands and global variables</h3>

<ul>
  <li>
    <p><strong>$all</strong> represents the general set of all reserved nodes.It is an object of ResourceSet class which contains the references to all reserved nodes represented by Resource objects. To check all the methods of ResourceSet and Resource classes see <strong>lib/resourceset.rb</strong></p>
  </li>
  <li>
    <p><strong>task (node, command)</strong> - execute <strong>command</strong> on <strong>node</strong> and wait till the command finishes its execution</p>
  </li>
  <li><strong>atask (node, command)</strong> - asyncronous task. Execute <strong>command</strong> on <strong>node</strong> and do not wait till the command finishes its execution</li>
  <li><strong>barrier</strong> - wait for all asynchronous tasks to finish</li>
  <li><strong>ptask (location, targets, command)</strong> - parallel task. Run <strong>command</strong> from <strong>location</strong> on all the <strong>targets</strong> in parallel, and wait till the command finishes.</li>
  <li><strong>copy (file, node, path={})</strong> - copy <strong>file</strong> to <strong>node</strong> to the specified <strong>path</strong>. If path is not specified - copy to the default folder.</li>
  <li><strong>parallel_section( &amp;block )</strong> - executes sequential sections which are called in the <strong>block</strong> in parallel.</li>
  <li><strong>sequential_section( &amp;block )</strong> &#8211; should be called from parallel_section; code from the block is executed sequentially.</li>
</ul>

<p><a name="contact"></a></p>

<h2 id="contact">Contact</h2>

<p>cristian.ruiz@imag.fr or report a bug in <a href="https://gforge.inria.fr/mail/?group_id=286" target="_parent" title="Expo Mailing List">Expo Mailing List</a></p>

<p><a name="publications"></a></p>

<h2 id="related-publications">Related Publications</h2>

<p>Brice Videau, Corinne Touati, and Olivier Richard. 
Toward an experiment engine for lightweight grids. In MetroGrid workshop : Metrology for Grid Networks. ACM publishing, Lyon, France, October 2007.
<a href="file.Metro07.html" title="bibtex">bibtex</a></p>

<p>Brice Videau and Olivier Richard. Expo : un moteur de conduite d&#8217;expériences pour plates-formes dédiées. In Conférence Française en Systèmes d&#8217;Exploitation (CFSE), Fribourg, Switzerland, February 2008. 
<a href="file.CFSE6.html" title="bibtex">bibtex</a></p>

<h2 id="changelog">Changelog</h2>

<ul>
  <li>
    <p><strong>Nov.19.12</strong>: Released 0.4a experimental version for testing. The goal here is to get people testing Expo and know if it really makes easy the experimentation process.</p>
  </li>
  <li>
    <p><strong>Mar.8.10</strong>: Added Ruby commands.	  </p>
  </li>
</ul>
</div></div>

    <div id="footer">
  Generated on Mon Nov 19 13:00:39 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.2.1 (ruby-1.8.7).
</div>

  </body>
</html>