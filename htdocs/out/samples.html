<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="your description goes here" />
    <meta name="keywords" content="your,keywords,goes,here" />
    <meta name="author" content="Your Name  / Original design: Andreas Viklund - http://andreasviklund.com/" />
    <meta name="generator" content="webgen - http://webgen.rubyforge.org" />
    <link rel="stylesheet" type="text/css" href="default.css" />
    <title>Code samples</title>
  </head>

  <body>
    <div id="thetop">
      <a id="top"></a>
      <p class="hide">Skip to: <a href="#sitemenu" accesskey="2">Site menu</a> | <a href="#maincontent" accesskey="3">Main content</a></p>
    </div>

    <div id="container">
      <div id="main">

        <div id="logo">
          <h1>[<a href="index.html" accesskey="4">Expo</a>]</h1>
          <span id="tagline">EXPeriment cOnduct</span>
        </div>

        <div id="intro">
          <h2><a id="maincontent"></a>Experiment engine for distributed platforms</h2>
          <p></p>
        </div>
        <div class="clear"></div>

        <h2 id="a-simple-expo-program">A simple expo program</h2>

<div class="CodeRay">
  <div class="code"><pre><span class="no">1</span> require <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">'</span><span style="">expo_g5k</span><span style="color:#710">'</span></span>
<span class="no">2</span> oargridsub <span style="color:#A60">:res</span> =&gt; <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">gdx:nodes=10,helios:nodes=10</span><span style="color:#710">&quot;</span></span>
<span class="no">3</span> check <span style="color:#d70;font-weight:bold">$all</span>
<span class="no">4</span> ptask <span style="color:#d70;font-weight:bold">$all</span>.gateway, <span style="color:#d70;font-weight:bold">$all</span>, <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">date</span><span style="color:#710">&quot;</span></span>
<span class="no">5</span> id, res = ptask <span style="color:#d70;font-weight:bold">$all</span>[<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">gdx</span><span style="color:#710">&quot;</span></span>].gateway, <span style="color:#d70;font-weight:bold">$all</span>[<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">gdx</span><span style="color:#710">&quot;</span></span>], <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">sleep 1</span><span style="color:#710">&quot;</span></span>
<span class="no">6</span> res.each { |r| puts r.duration }
<span class="no">7</span> puts <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">mean : </span><span style="color:#710">&quot;</span></span> + res.mean_duration
</pre></div>
</div>

<p>This simple program takes place in the Grid&rsquo;5000 context. 20 resources are
obtained from 2 different clusters : helios and gdx. Those resources are
checked for non responding machines. After that each resource execute the
date command the result of the command is unused. After that each resource
from gdx runs the sleep 1 command. The duration of those commands is
automatically logged. The duration of the command for each resource is
printed on screen. The mean is also displayed.</p>

<h2 id="use-case">2 Use Case</h2>

<div class="CodeRay">
  <div class="code"><pre><span class="no"> 1</span> <span style="color:#888">##############################################</span>
<span class="no"> 2</span> <span style="color:#888"># Example 0: reserve some nodes and check them </span>
<span class="no"> 3</span> <span style="color:#888">#</span>
<span class="no"> 4</span> require <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">'</span><span style="">expo_g5k</span><span style="color:#710">'</span></span>
<span class="no"> 5</span> <span style="color:#d70;font-weight:bold">$reservation_type</span> = <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">oargrid2</span><span style="color:#710">&quot;</span></span>
<span class="no"> 6</span> 
<span class="no"> 7</span> <span style="color:#888">#Reservation</span>
<span class="no"> 8</span> oargridsub <span style="color:#A60">:res</span> =&gt; <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">paravent:rdef=</span><span style="color:#b0b">\&quot;</span><span style="">/nodes=1</span><span style="color:#b0b">\&quot;</span><span style="">,capricorne:rdef=</span><span style="color:#b0b">\&quot;</span><span style="">/nodes=1</span><span style="color:#b0b">\&quot;</span><span style="color:#710">&quot;</span></span>
<span class="no"> 9</span> 
<span class="no"><strong>10</strong></span> <span style="color:#888">#Check all nodes (which is default test ?)</span>
<span class="no">11</span> check <span style="color:#d70;font-weight:bold">$all</span>
<span class="no">12</span> 
<span class="no">13</span> puts <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">Gateways :</span><span style="color:#710">&quot;</span></span>
<span class="no">14</span> <span style="color:#d70;font-weight:bold">$all</span>.each( <span style="color:#A60">:resource_set</span> ) { |s|
<span class="no">15</span>         puts s.gw
<span class="no">16</span> }
<span class="no">17</span> 
</pre></div>
</div>

<h2 id="use-case-1">3 Use Case</h2>

<div class="CodeRay">
  <div class="code"><pre><span class="no">1</span> require <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">'</span><span style="">expo_g5k</span><span style="color:#710">'</span></span>
<span class="no">2</span> oargridsub <span style="color:#A60">:res</span> =&gt; <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">toulouse:nodes=2,lille:nodes=10</span><span style="color:#710">&quot;</span></span>
<span class="no">3</span> 
<span class="no">4</span> task1=<span style="color:#036;font-weight:bold">Task</span>::new(<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">hostname</span><span style="color:#710">&quot;</span></span>,<span style="color:#d70;font-weight:bold">$all</span>,<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">Test 1</span><span style="color:#710">&quot;</span></span>)
<span class="no">5</span> id, res = task1.execute
<span class="no">6</span> res.each { |r| puts r.duration }
<span class="no">7</span> puts <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">mean : </span><span style="color:#710">&quot;</span></span> + res.mean_duration
</pre></div>
</div>

<p>In this example the class Task is use in order to execute the especific task in parallel over the resource Set.</p>


      </div>

      <div id="sidebar">

        <h2 class="sidelink menuheader"><a id="sitemenu"></a>Menu:</h2>
        <div id="menu"><ul><li class="webgen-menu-level1"><a href="index.html">Expo homepage</a></li><li class="webgen-menu-level1 webgen-menu-item-selected"><span>Code samples</span></li><li class="webgen-menu-level1"><a href="Documentation.html">Documentation</a></li><li class="webgen-menu-level1"><a href="publications.html">Related Publications</a></li></ul></div>
        <a class="hide" href="#top" accesskey="1">Top of page</a>

        <h3>Regular links</h3>
        <ul class="linklist">
          <li><a href="http://andreasviklund.com/templates">Free website templates</a></li>
          <li><a href="http://gforge.inria.fr/projects/expo/">Expo forge</a></li>
          <li><a href="doc/">Ruby Doc</a></li>
        </ul>

      </div>
      <div class="clear">&nbsp;</div>
    </div>

    <div id="footer"><p>&copy; 2005-2012 Brice Videau | Generated by <a href="http://webgen.rubyforge.org/">webgen</a> | Design by <a href="http://andreasviklund.com">Andreas Viklund</a></p></div>

  </body>
</html>
